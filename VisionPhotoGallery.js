var VisionPhotoGallery;VisionPhotoGallery=function(){"use strict";var t={352:function(){function t(t,o){for(var e=0;e<o.length;e++){var n=o[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}var e=function(){function o(t){var e=t.root,n=t.personId,r=t.token;if(function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,o),!e)throw new Error("Не указан ID корневого элемента для галереи!");var i=document.getElementById(e);if(!i)throw new Error("Проверьте указанный ID корневого элемента для галереи!");if(this.constructor.rootElement=i,!n)throw new Error("Не указан ID пользователя на портале Vision");this.personId=n,this.token=r,this.constructor.draw()}var e,n,r;return e=o,r=[{key:"request",value:function(t){var o=t.requestPath,e=t.requestBody,n={method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRFToken":this.token},body:JSON.stringify(e)};return fetch("/api/v2/vision/".concat(o,"/"),n)}},{key:"getPhotos",value:function(){return this.request({requestPath:"get_photos",requestBody:{person_id:this.personId,masterAlbum:!0}})}},{key:"addPhoto",value:function(t){return this.request({requestPath:"add_photo",requestBody:{person_id:this.personId,image:t}})}},{key:"deletePhoto",value:function(t){return this.request({requestPath:"delete_photo",requestBody:{person_id:this.personId,photo_ids:[t],masterAlbum:!0}})}},{key:"updatePhoto",value:function(t){return this.request({requestPath:"delete_photo",requestBody:{person_id:this.personId,photo_id:t,masterAlbum:!0}})}},{key:"draw",value:function(){var t=this,o=this.rootElement;o.innerHTML='\n            <div class="vision-photo-gallery">\n                <input type="file" class="vision-photo-gallery__file-field" tabindex="-1">\n                <div class="vision-photo-gallery__item vision-photo-gallery__item--main">\n                    <h4 class="vision-photo-gallery__title">Основная фотография</h4>\n                    <div class="vg-main-photo"></div>\n                </div>\n                <div class="vision-photo-gallery__item">\n                    <h4 class="vision-photo-gallery__title">Галерея</h4>\n                    <div class="vg-gallery"></div>\n                </div>\n            </div>\n        ';var e=o.querySelector(".vg-main-photo"),n=o.querySelector(".vg-gallery");this.getPhotos().then((function(o){if(e.innerHTML=t.createPhotoElement({main:!0,empty:!0,photoId:null}),n.innerHTML=t.createPhotoElement({main:!1,empty:!0,photoId:null}),o.ok)return o.json();e.innerHTML=t.createPhotoElement({main:!0,empty:!0,photoId:null})})).then((function(o){var r=o.find((function(t){return!0===t.main})),i=o.filter((function(t){return!0!==t.main}));if(r?e.innerHTML=t.createPhotoElement(r):e.parentElement.classList.add("hidden"),i.length){var a="";i.forEach((function(o){return a+=t.createPhotoElement(o)})),n.innerHTML=a}t.initEvents()})).catch((function(t){console.log(t)}))}},{key:"createPhotoElement",value:function(t){var o=t.photoId,e=t.main,n=t.empty,r=t.path,i=t.avatarUrl,a="",u="",s="",c="";return r&&(s='style="background-image: url('.concat(r,')"')),i&&(s='style="background-image: url('.concat(i,')"')),e&&(c='data-main="'.concat(e,'"')),e&&!n||e&&n?(u="vg-photo vg-photo--main",a='\n                <button class="vg-photo__button vg-button vg-button--red" data-action="remove-photo">Удалить</button>\n            '):!e&&n?(u="vg-gallery__item vg-photo vg-photo--upload",a='\n                <button class="vg-photo__button vg-button vg-button--upload" data-action="upload-photo">&#43;</button>\n            '):(u="vg-gallery__item vg-photo",a='\n                <button class="vg-photo__button vg-button vg-button--green" data-action="choose-photo">Выбрать</button>\n                <button class="vg-photo__button vg-button vg-button--red" data-action="remove-photo">Удалить</button>\n            '),'\n            <div class="'.concat(u,'"\n                ').concat(s,'\n                data-photo-id="').concat(o,'"\n                ').concat(c,">\n                ").concat(a,"\n            </div>\n        ")}},{key:"initEvents",value:function(){var t=this;this.rootElement.querySelectorAll("button").forEach((function(o){o.addEventListener("click",t.router[o.dataset.action],!1)}))}}],(n=[{key:"personId",get:function(){return this.constructor.personId},set:function(t){t&&(this.constructor.personId=t)}},{key:"rootElement",get:function(){return this.constructor.rootElement}},{key:"token",get:function(){return this.constructor.token},set:function(t){t&&(this.constructor.token=t)}}])&&t(e.prototype,n),r&&t(e,r),o}();o(e,"personId",null),o(e,"rootElement",null),o(e,"token",null),o(e,"router",{"upload-photo":function(t){var o=e.rootElement.querySelector('input[type="file"]');o.addEventListener("change",e.router["file-input-changed"]),o.click()},"file-input-changed":function(t){var o=t.target.files[0],n=new FileReader;n.readAsDataURL(o),n.onload=function(){e.addPhoto(n.result).then((function(t){t.ok&&e.draw()})).catch((function(t){console.log(t)}))},n.onerror=function(){throw new Error("Ошибка загрузки фотографии (-ий): ".concat(n.error))}},"remove-photo":function(t){var o=t.target.closest(".vg-photo").dataset.photoId;o&&e.deletePhoto(o).then((function(t){t.ok&&e.draw()}))},"update-photo":function(t){var o=t.target.closest(".vg-photo").dataset.photoId;o&&e.updatePhoto(o).then((function(t){t.ok&&e.draw()})).catch((function(t){console.log(t)}))}})}},o={};return function e(n){if(o[n])return o[n].exports;var r=o[n]={exports:{}};return t[n](r,r.exports,e),r.exports}(352)}().default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9WaXNpb25QaG90b0dhbGxlcnkvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vVmlzaW9uUGhvdG9HYWxsZXJ5L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL1Zpc2lvblBob3RvR2FsbGVyeS93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsiVmlzaW9uUGhvdG9HYWxsZXJ5Iiwicm9vdCIsInBlcnNvbklkIiwidG9rZW4iLCJFcnJvciIsInJvb3RFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRoaXMiLCJjb25zdHJ1Y3RvciIsImRyYXciLCJyZXF1ZXN0UGF0aCIsInJlcXVlc3RCb2R5IiwicmVxdWVzdERlZmF1bHRzIiwibWV0aG9kIiwibW9kZSIsImNyZWRlbnRpYWxzIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZmV0Y2giLCJyZXF1ZXN0IiwicGVyc29uX2lkIiwibWFzdGVyQWxidW0iLCJpbWFnZSIsInBob3RvSWQiLCJwaG90b19pZHMiLCJwaG90b19pZCIsImlubmVySFRNTCIsIm1haW5QaG90b0NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJnYWxsZXJ5IiwiZ2V0UGhvdG9zIiwidGhlbiIsInJlc3BvbnNlIiwiY3JlYXRlUGhvdG9FbGVtZW50IiwibWFpbiIsImVtcHR5Iiwib2siLCJqc29uIiwicmVzcG9uc2VKc29uIiwibWFpblBob3RvRGF0YSIsImZpbmQiLCJnYWxsZXJ5UGhvdG9zRGF0YSIsImZpbHRlciIsInBhcmVudEVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJsZW5ndGgiLCJnYWxsZXJ5UGhvdG9zSHRtbCIsImZvckVhY2giLCJwaG90b0RhdGEiLCJpbml0RXZlbnRzIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJwYXJhbXMiLCJwYXRoIiwiYXZhdGFyVXJsIiwiYnV0dG9ucyIsImVsZW1lbnRDbGFzc2VzIiwiYmFja2dyb3VuZEltYWdlIiwibWFpbkF0dHJpYnV0ZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwicm91dGVyIiwiZGF0YXNldCIsImFjdGlvbiIsImUiLCJmaWxlSW5wdXQiLCJjbGljayIsImZpbGUiLCJ0YXJnZXQiLCJmaWxlcyIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJyZWFkQXNEYXRhVVJMIiwib25sb2FkIiwiYWRkUGhvdG8iLCJyZXN1bHQiLCJvbmVycm9yIiwiY2xvc2VzdCIsImRlbGV0ZVBob3RvIiwidXBkYXRlUGhvdG8iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyJdLCJtYXBwaW5ncyI6IjBYQUlNQSxFLFdBS0YsY0FBcUMsSUFBeEJDLEVBQXdCLEVBQXhCQSxLQUFNQyxFQUFrQixFQUFsQkEsU0FBVUMsRUFBUSxFQUFSQSxNQUN6QixHLDRGQURpQyxVQUM1QkYsRUFDRCxNQUFNLElBQUlHLE1BQU0sZ0RBR3BCLElBQU1DLEVBQWNDLFNBQVNDLGVBQWVOLEdBRTVDLElBQU1JLEVBR0YsTUFBTSxJQUFJRCxNQUFNLDBEQUdwQixHQUxJSSxLQUFLQyxZQUFZSixZQUFjQSxHQUs5QkgsRUFDRCxNQUFNLElBQUlFLE1BQU0sK0NBR3BCSSxLQUFLTixTQUFXQSxFQUNoQk0sS0FBS0wsTUFBUUEsRUFFYkssS0FBS0MsWUFBWUMsTyx5REFrQ3NCLElBQTNCQyxFQUEyQixFQUEzQkEsWUFBYUMsRUFBYyxFQUFkQSxZQUNuQkMsRUFBa0IsQ0FDcEJDLE9BQVEsT0FDUkMsS0FBTSxjQUNOQyxZQUFhLGNBQ2JDLFFBQVMsQ0FDTCxlQUFnQixtQkFDaEIsY0FBZVQsS0FBS0wsT0FFeEJlLEtBQU1DLEtBQUtDLFVBQVVSLElBR3pCLE9BQU9TLE1BQU0sa0JBQUQsT0FBbUJWLEVBQW5CLEtBQW1DRSxLLGtDQUkvQyxPQUFPTCxLQUFLYyxRQUFR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WSxDQUdqREMsUUFBUyxJQU9WLE9BSEFFLEVBQW9CSCxHQUFVRSxFQUFRQSxFQUFPRCxRQUFTRixHQUcvQ0csRUFBT0QsUUNqQlJGLENBQW9CLEsiLCJmaWxlIjoiVmlzaW9uUGhvdG9HYWxsZXJ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgJy4vYXBwLnNjc3MnO1xuXG5jbGFzcyBWaXNpb25QaG90b0dhbGxlcnkge1xuICAgIHN0YXRpYyBwZXJzb25JZCA9IG51bGw7XG4gICAgc3RhdGljIHJvb3RFbGVtZW50ID0gbnVsbDtcbiAgICBzdGF0aWMgdG9rZW4gPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3Ioe3Jvb3QsIHBlcnNvbklkLCB0b2tlbn0pIHtcbiAgICAgICAgaWYgKCFyb290KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ9Cd0LUg0YPQutCw0LfQsNC9IElEINC60L7RgNC90LXQstC+0LPQviDRjdC70LXQvNC10L3RgtCwINC00LvRjyDQs9Cw0LvQtdGA0LXQuCEnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJvb3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocm9vdCk7XG5cbiAgICAgICAgaWYgKCEhcm9vdEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuY29uc3RydWN0b3Iucm9vdEVsZW1lbnQgPSByb290RWxlbWVudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcign0J/RgNC+0LLQtdGA0YzRgtC1INGD0LrQsNC30LDQvdC90YvQuSBJRCDQutC+0YDQvdC10LLQvtCz0L4g0Y3Qu9C10LzQtdC90YLQsCDQtNC70Y8g0LPQsNC70LXRgNC10LghJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXBlcnNvbklkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ9Cd0LUg0YPQutCw0LfQsNC9IElEINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQvdCwINC/0L7RgNGC0LDQu9C1IFZpc2lvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wZXJzb25JZCA9IHBlcnNvbklkO1xuICAgICAgICB0aGlzLnRva2VuID0gdG9rZW47XG5cbiAgICAgICAgdGhpcy5jb25zdHJ1Y3Rvci5kcmF3KCk7XG4gICAgfVxuXG4gICAgZ2V0IHBlcnNvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5wZXJzb25JZDtcbiAgICB9XG5cbiAgICBzZXQgcGVyc29uSWQocGVyc29uSWQpIHtcbiAgICAgICAgaWYgKHBlcnNvbklkKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnN0cnVjdG9yLnBlcnNvbklkID0gcGVyc29uSWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgcm9vdEVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yLnJvb3RFbGVtZW50O1xuICAgIH1cblxuICAgIGdldCB0b2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IudG9rZW47XG4gICAgfVxuXG4gICAgc2V0IHRva2VuKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdGhpcy5jb25zdHJ1Y3Rvci50b2tlbiA9IHRva2VuO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog0J7QsdGR0YDRgtC60LAg0LTQu9GPINC30LDQv9GA0L7RgdC+0LIg0LogQVBJLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXRoIHtzdHJpbmd9INCd0LDQt9Cy0LDQvdC40LUg0LzQtdGC0L7QtNCwIEFQSS5cbiAgICAgKiBAcGFyYW0gcmVxdWVzdEJvZHkge29iamVjdH0g0J/QsNGA0LDQvNC10YLRgNGLINC30LDQv9GA0L7RgdCwLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0g0J/RgNC+0LzQuNGBINC30LDQv9GA0L7RgdCwLlxuICAgICAqL1xuICAgIHN0YXRpYyByZXF1ZXN0KHtyZXF1ZXN0UGF0aCwgcmVxdWVzdEJvZHl9KSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3REZWZhdWx0cyA9IHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgbW9kZTogJ3NhbWUtb3JpZ2luJyxcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ1gtQ1NSRlRva2VuJzogdGhpcy50b2tlbixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSksXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZldGNoKGAvYXBpL3YyL3Zpc2lvbi8ke3JlcXVlc3RQYXRofS9gLCByZXF1ZXN0RGVmYXVsdHMpO1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRQaG90b3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgcmVxdWVzdFBhdGg6ICdnZXRfcGhvdG9zJyxcbiAgICAgICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgICAgICAgcGVyc29uX2lkOiB0aGlzLnBlcnNvbklkLFxuICAgICAgICAgICAgICAgIG1hc3RlckFsYnVtOiB0cnVlLFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgYWRkUGhvdG8oaW1hZ2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICByZXF1ZXN0UGF0aDogJ2FkZF9waG90bycsXG4gICAgICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgICAgICAgIHBlcnNvbl9pZDogdGhpcy5wZXJzb25JZCxcbiAgICAgICAgICAgICAgICBpbWFnZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBkZWxldGVQaG90byhwaG90b0lkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgcmVxdWVzdFBhdGg6ICdkZWxldGVfcGhvdG8nLFxuICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICBwZXJzb25faWQ6IHRoaXMucGVyc29uSWQsXG4gICAgICAgICAgICAgICAgcGhvdG9faWRzOiBbcGhvdG9JZF0sXG4gICAgICAgICAgICAgICAgbWFzdGVyQWxidW06IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIHN0YXRpYyB1cGRhdGVQaG90byhwaG90b0lkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgcmVxdWVzdFBhdGg6ICdkZWxldGVfcGhvdG8nLFxuICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICBwZXJzb25faWQ6IHRoaXMucGVyc29uSWQsXG4gICAgICAgICAgICAgICAgcGhvdG9faWQ6IHBob3RvSWQsXG4gICAgICAgICAgICAgICAgbWFzdGVyQWxidW06IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZHJhdygpIHtcbiAgICAgICAgY29uc3Qgcm9vdEVsZW1lbnQgPSB0aGlzLnJvb3RFbGVtZW50O1xuXG4gICAgICAgIHJvb3RFbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2aXNpb24tcGhvdG8tZ2FsbGVyeVwiPlxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZmlsZVwiIGNsYXNzPVwidmlzaW9uLXBob3RvLWdhbGxlcnlfX2ZpbGUtZmllbGRcIiB0YWJpbmRleD1cIi0xXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInZpc2lvbi1waG90by1nYWxsZXJ5X19pdGVtIHZpc2lvbi1waG90by1nYWxsZXJ5X19pdGVtLS1tYWluXCI+XG4gICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzcz1cInZpc2lvbi1waG90by1nYWxsZXJ5X190aXRsZVwiPtCe0YHQvdC+0LLQvdCw0Y8g0YTQvtGC0L7Qs9GA0LDRhNC40Y88L2g0PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidmctbWFpbi1waG90b1wiPjwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2aXNpb24tcGhvdG8tZ2FsbGVyeV9faXRlbVwiPlxuICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3M9XCJ2aXNpb24tcGhvdG8tZ2FsbGVyeV9fdGl0bGVcIj7Qk9Cw0LvQtdGA0LXRjzwvaDQ+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2Zy1nYWxsZXJ5XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCBtYWluUGhvdG9Db250YWluZXIgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcudmctbWFpbi1waG90bycpO1xuICAgICAgICBjb25zdCBnYWxsZXJ5ID0gcm9vdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnZnLWdhbGxlcnknKTtcblxuXG4gICAgICAgIHRoaXMuZ2V0UGhvdG9zKCkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBtYWluUGhvdG9Db250YWluZXIuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVQaG90b0VsZW1lbnQoe1xuICAgICAgICAgICAgICAgIG1haW46IHRydWUsXG4gICAgICAgICAgICAgICAgZW1wdHk6IHRydWUsXG4gICAgICAgICAgICAgICAgcGhvdG9JZDogbnVsbFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGdhbGxlcnkuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVQaG90b0VsZW1lbnQoe1xuICAgICAgICAgICAgICAgIG1haW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVtcHR5OiB0cnVlLFxuICAgICAgICAgICAgICAgIHBob3RvSWQ6IG51bGwsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWFpblBob3RvQ29udGFpbmVyLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlUGhvdG9FbGVtZW50KHttYWluOiB0cnVlLCBlbXB0eTogdHJ1ZSwgcGhvdG9JZDogbnVsbH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKHJlc3BvbnNlSnNvbiA9PiB7XG4gICAgICAgICAgICBjb25zdCBtYWluUGhvdG9EYXRhID0gcmVzcG9uc2VKc29uLmZpbmQoKHttYWlufSkgPT4gbWFpbiA9PT0gdHJ1ZSk7XG4gICAgICAgICAgICBjb25zdCBnYWxsZXJ5UGhvdG9zRGF0YSA9IHJlc3BvbnNlSnNvbi5maWx0ZXIoKHttYWlufSkgPT4gbWFpbiAhPT0gdHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmIChtYWluUGhvdG9EYXRhKSB7XG4gICAgICAgICAgICAgICAgbWFpblBob3RvQ29udGFpbmVyLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlUGhvdG9FbGVtZW50KG1haW5QaG90b0RhdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYWluUGhvdG9Db250YWluZXIucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdhbGxlcnlQaG90b3NEYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGxldCBnYWxsZXJ5UGhvdG9zSHRtbCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgZ2FsbGVyeVBob3Rvc0RhdGEuZm9yRWFjaCgocGhvdG9EYXRhKSA9PiBnYWxsZXJ5UGhvdG9zSHRtbCArPSB0aGlzLmNyZWF0ZVBob3RvRWxlbWVudChwaG90b0RhdGEpKTtcbiAgICAgICAgICAgICAgICBnYWxsZXJ5LmlubmVySFRNTCA9IGdhbGxlcnlQaG90b3NIdG1sXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuaW5pdEV2ZW50cygpO1xuICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHN0YXRpYyBjcmVhdGVQaG90b0VsZW1lbnQocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHtwaG90b0lkLCBtYWluLCBlbXB0eSwgcGF0aCwgYXZhdGFyVXJsfSA9IHBhcmFtcztcbiAgICAgICAgbGV0IGJ1dHRvbnMgPSAnJztcbiAgICAgICAgbGV0IGVsZW1lbnRDbGFzc2VzID0gJyc7XG4gICAgICAgIGxldCBiYWNrZ3JvdW5kSW1hZ2UgPSAnJztcbiAgICAgICAgbGV0IG1haW5BdHRyaWJ1dGUgPSAnJztcblxuICAgICAgICBpZiAocGF0aCkge1xuICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlID0gYHN0eWxlPVwiYmFja2dyb3VuZC1pbWFnZTogdXJsKCR7cGF0aH0pXCJgO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGF2YXRhclVybCkge1xuICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlID0gYHN0eWxlPVwiYmFja2dyb3VuZC1pbWFnZTogdXJsKCR7YXZhdGFyVXJsfSlcImA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWFpbikge1xuICAgICAgICAgICAgbWFpbkF0dHJpYnV0ZSA9IGBkYXRhLW1haW49XCIke21haW59XCJgO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1haW4gJiYgIWVtcHR5KSB7XG4gICAgICAgICAgICBlbGVtZW50Q2xhc3NlcyA9ICd2Zy1waG90byB2Zy1waG90by0tbWFpbic7XG4gICAgICAgICAgICBidXR0b25zID0gYFxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJ2Zy1waG90b19fYnV0dG9uIHZnLWJ1dHRvbiB2Zy1idXR0b24tLXJlZFwiIGRhdGEtYWN0aW9uPVwicmVtb3ZlLXBob3RvXCI+0KPQtNCw0LvQuNGC0Yw8L2J1dHRvbj5cbiAgICAgICAgICAgIGA7XG4gICAgICAgIH0gZWxzZSBpZiAobWFpbiAmJiBlbXB0eSkge1xuICAgICAgICAgICAgZWxlbWVudENsYXNzZXMgPSAndmctcGhvdG8gdmctcGhvdG8tLW1haW4nO1xuICAgICAgICAgICAgYnV0dG9ucyA9IGBcbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwidmctcGhvdG9fX2J1dHRvbiB2Zy1idXR0b24gdmctYnV0dG9uLS1yZWRcIiBkYXRhLWFjdGlvbj1cInJlbW92ZS1waG90b1wiPtCj0LTQsNC70LjRgtGMPC9idXR0b24+XG4gICAgICAgICAgICBgO1xuICAgICAgICB9IGVsc2UgaWYgKCFtYWluICYmIGVtcHR5KSB7XG4gICAgICAgICAgICBlbGVtZW50Q2xhc3NlcyA9ICd2Zy1nYWxsZXJ5X19pdGVtIHZnLXBob3RvIHZnLXBob3RvLS11cGxvYWQnO1xuICAgICAgICAgICAgYnV0dG9ucyA9IGBcbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwidmctcGhvdG9fX2J1dHRvbiB2Zy1idXR0b24gdmctYnV0dG9uLS11cGxvYWRcIiBkYXRhLWFjdGlvbj1cInVwbG9hZC1waG90b1wiPiYjNDM7PC9idXR0b24+XG4gICAgICAgICAgICBgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWxlbWVudENsYXNzZXMgPSAndmctZ2FsbGVyeV9faXRlbSB2Zy1waG90byc7XG4gICAgICAgICAgICBidXR0b25zID0gYFxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJ2Zy1waG90b19fYnV0dG9uIHZnLWJ1dHRvbiB2Zy1idXR0b24tLWdyZWVuXCIgZGF0YS1hY3Rpb249XCJjaG9vc2UtcGhvdG9cIj7QktGL0LHRgNCw0YLRjDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJ2Zy1waG90b19fYnV0dG9uIHZnLWJ1dHRvbiB2Zy1idXR0b24tLXJlZFwiIGRhdGEtYWN0aW9uPVwicmVtb3ZlLXBob3RvXCI+0KPQtNCw0LvQuNGC0Yw8L2J1dHRvbj5cbiAgICAgICAgICAgIGA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIiR7ZWxlbWVudENsYXNzZXN9XCJcbiAgICAgICAgICAgICAgICAke2JhY2tncm91bmRJbWFnZX1cbiAgICAgICAgICAgICAgICBkYXRhLXBob3RvLWlkPVwiJHtwaG90b0lkfVwiXG4gICAgICAgICAgICAgICAgJHttYWluQXR0cmlidXRlfT5cbiAgICAgICAgICAgICAgICAke2J1dHRvbnN9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICB9XG5cbiAgICBzdGF0aWMgaW5pdEV2ZW50cygpIHtcbiAgICAgICAgY29uc3Qge3Jvb3RFbGVtZW50fSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGJ1dHRvbnMgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKTtcblxuICAgICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucm91dGVyW2J1dHRvbi5kYXRhc2V0LmFjdGlvbl0sIGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc3RhdGljIHJvdXRlciA9IHtcbiAgICAgICAgJ3VwbG9hZC1waG90byc6IChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWxlSW5wdXQgPSB0aGlzLnJvb3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgICAgICAgICAgIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLnJvdXRlclsnZmlsZS1pbnB1dC1jaGFuZ2VkJ10pO1xuICAgICAgICAgICAgZmlsZUlucHV0LmNsaWNrKCk7XG4gICAgICAgIH0sXG4gICAgICAgICdmaWxlLWlucHV0LWNoYW5nZWQnOiAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzWzBdO1xuICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XG5cbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRQaG90byhyZWFkZXIucmVzdWx0KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihg0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0YTQvtGC0L7Qs9GA0LDRhNC40LggKC3QuNC5KTogJHtyZWFkZXIuZXJyb3J9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgICdyZW1vdmUtcGhvdG8nOiAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGhvdG9FbGVtZW50ID0gZS50YXJnZXQuY2xvc2VzdCgnLnZnLXBob3RvJyk7XG4gICAgICAgICAgICBjb25zdCB7cGhvdG9JZH0gPSBwaG90b0VsZW1lbnQuZGF0YXNldDtcblxuICAgICAgICAgICAgaWYgKCEhcGhvdG9JZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlUGhvdG8ocGhvdG9JZClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAndXBkYXRlLXBob3RvJzogKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBob3RvRWxlbWVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy52Zy1waG90bycpO1xuICAgICAgICAgICAgY29uc3Qge3Bob3RvSWR9ID0gcGhvdG9FbGVtZW50LmRhdGFzZXQ7XG5cbiAgICAgICAgICAgIGlmICghIXBob3RvSWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVBob3RvKHBob3RvSWQpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9XG59IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBtb2R1bGUgZXhwb3J0cyBtdXN0IGJlIHJldHVybmVkIGZyb20gcnVudGltZSBzbyBlbnRyeSBpbmxpbmluZyBpcyBkaXNhYmxlZFxuLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5yZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygzNTIpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==