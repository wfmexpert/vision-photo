!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VisionPhotoGallery=e():t.VisionPhotoGallery=e()}(this,(function(){return function(){"use strict";var t={d:function(e,o){for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return S}});var o="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==o&&o,r="URLSearchParams"in o,n="Symbol"in o&&"iterator"in Symbol,i="FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch(t){return!1}}(),s="FormData"in o,a="ArrayBuffer"in o;if(a)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(t){return t&&u.indexOf(Object.prototype.toString.call(t))>-1};function h(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function c(t){return"string"!=typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function y(t){return new Promise((function(e,o){t.onload=function(){e(t.result)},t.onerror=function(){o(t.error)}}))}function m(t){var e=new FileReader,o=y(e);return e.readAsArrayBuffer(t),o}function v(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:s&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():a&&i&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(t)||l(t))?this._bodyArrayBuffer=v(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(m)}),this.text=function(){var t,e,o,r=p(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,o=y(e=new FileReader),e.readAsText(t),o;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),o=new Array(e.length),r=0;r<e.length;r++)o[r]=String.fromCharCode(e[r]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=h(t),e=c(e);var o=this.map[t];this.map[t]=o?o+", "+e:e},f.prototype.delete=function(t){delete this.map[h(t)]},f.prototype.get=function(t){return t=h(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(h(t))},f.prototype.set=function(t,e){this.map[h(t)]=c(e)},f.prototype.forEach=function(t,e){for(var o in this.map)this.map.hasOwnProperty(o)&&t.call(e,this.map[o],o,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,o){t.push(o)})),d(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),d(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,o){t.push([o,e])})),d(t)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var o,r,n=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(r=(o=e.method||this.method||"GET").toUpperCase(),b.indexOf(r)>-1?r:o),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function E(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var o=t.split("="),r=o.shift().replace(/\+/g," "),n=o.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(n))}})),e}function P(t,e){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},g.call(w.prototype),g.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},P.error=function(){var t=new P(null,{status:0,statusText:""});return t.type="error",t};var _=[301,302,303,307,308];P.redirect=function(t,e){if(-1===_.indexOf(e))throw new RangeError("Invalid status code");return new P(null,{status:e,headers:{location:t}})};var O=o.DOMException;try{new O}catch(t){(O=function(t,e){this.message=t,this.name=e;var o=Error(t);this.stack=o.stack}).prototype=Object.create(Error.prototype),O.prototype.constructor=O}function A(t,e){return new Promise((function(r,n){var s=new w(t,e);if(s.signal&&s.signal.aborted)return n(new O("Aborted","AbortError"));var u=new XMLHttpRequest;function l(){u.abort()}u.onload=function(){var t,e,o={status:u.status,statusText:u.statusText,headers:(t=u.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var o=t.split(":"),r=o.shift().trim();if(r){var n=o.join(":").trim();e.append(r,n)}})),e)};o.url="responseURL"in u?u.responseURL:o.headers.get("X-Request-URL");var n="response"in u?u.response:u.responseText;setTimeout((function(){r(new P(n,o))}),0)},u.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},u.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},u.onabort=function(){setTimeout((function(){n(new O("Aborted","AbortError"))}),0)},u.open(s.method,function(t){try{return""===t&&o.location.href?o.location.href:t}catch(e){return t}}(s.url),!0),"include"===s.credentials?u.withCredentials=!0:"omit"===s.credentials&&(u.withCredentials=!1),"responseType"in u&&(i?u.responseType="blob":a&&s.headers.get("Content-Type")&&-1!==s.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!e||"object"!=typeof e.headers||e.headers instanceof f?s.headers.forEach((function(t,e){u.setRequestHeader(e,t)})):Object.getOwnPropertyNames(e.headers).forEach((function(t){u.setRequestHeader(t,c(e.headers[t]))})),s.signal&&(s.signal.addEventListener("abort",l),u.onreadystatechange=function(){4===u.readyState&&s.signal.removeEventListener("abort",l)}),u.send(void 0===s._bodyInit?null:s._bodyInit)}))}function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function T(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function k(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?T(Object(o),!0).forEach((function(e){j(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):T(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function B(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}A.polyfill=!0,o.fetch||(o.fetch=A,o.Headers=f,o.Request=w,o.Response=P);var S=function(){function t(e){var o=this,r=e.root,n=e.employeeId,i=e.visionPersonId,s=e.personId,a=e.token,u=e.controls,l=e.masterAlbum,h=void 0===l||l;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,"galleryContainer",null),j(this,"rootElement",null),j(this,"token",null),j(this,"controls",{disableAll:!1,update:!0,upload:!0,remove:!0}),j(this,"masterAlbum",!0),j(this,"errorFunction",null),j(this,"successFunction",null),j(this,"router",{"upload-photo":function(t){var e=o.rootElement.querySelector('input[type="file"]');e.addEventListener("change",o.router["file-input-changed"]),e.click()},"file-input-changed":function(t){var e=t.target.files[0],r=new FileReader;r.readAsDataURL(e),r.onload=function(){o.addPhoto(r.result).then((function(t){if(t.faultcode&&o.handleError({message:t}),t.ok)o.draw({action:"uploadPhoto"});else if(200!==t.status)return t.json()}),(function(t){o.handleError({message:t})}))},r.onerror=function(){o.handleError({message:r.error,blockingErrorMessage:"Ошибка загрузки фотографии (-ий): ".concat(r.error)})}},"remove-photo":function(t){var e=t.target.closest(".vg-photo"),r=e.dataset.photoId,n=e.classList.contains("vg-photo--main");r&&o.deletePhoto(+r).then((function(t){if(t.faultcode)o.handleError({message:t});else if(t.ok)o.draw({action:n?"photoRemoveMain":"photoRemove"});else if(200!==t.status)return t.json()}),(function(t){o.handleError({message:t})}))},"update-photo":function(t){var e=t.target.closest(".vg-photo"),r=e.dataset.photoId,n=e.querySelectorAll("button");r&&(n.forEach((function(t){return t.setAttribute("disabled","disabled")})),o.setAsMainPhoto(+r).then((function(t){if(t.ok)o.draw({action:"photoAlbum"});else if(200!==t.status)return t.json()}),(function(t){o.handleError({message:t})})))}}),!r)throw new Error("Не указан ID корневого элемента для галереи!");var c=document.getElementById(r);if(!c)throw new Error("Проверьте указанный ID корневого элемента для галереи!");if(this.rootElement=c,!n&&!i&&!s)throw new Error("Не указан ID пользователя на портале Vision");this.employee={id:null,personId:null,visionPersonId:null},this.employeeId=n,this.visionPersonId=i,this.personId=s,this.token=a,this.controls=u,this.masterAlbum=h,this.draw()}var e,o;return e=t,o=[{key:"errorFunction",get:function(){return this.errorFunction},set:function(t){t&&(this.errorFunction=t)}},{key:"successFunction",get:function(){return this.successFunction},set:function(t){t&&(this.successFunction=t)}},{key:"update",value:function(t){var e=t.employeeId,o=t.token;this.employeeId=e,this.token=o,this.draw()}},{key:"employeeId",get:function(){return this.employee.id},set:function(t){t&&(this.employee.id=t)}},{key:"visionPersonId",get:function(){return this.employee.visionPersonId},set:function(t){t&&(this.employee.visionPersonId=t)}},{key:"personId",get:function(){return this.employee.personId},set:function(t){t&&(this.employee.personId=t)}},{key:"rootElement",get:function(){return this.rootElement}},{key:"token",get:function(){return this.token},set:function(t){t&&(this.token=t)}},{key:"controls",get:function(){return this.controls},set:function(t){this.controls=k(k({},this.controls),t)}},{key:"masterAlbum",get:function(){return this.masterAlbum},set:function(t){this.masterAlbum=t}},{key:"handleError",value:function(t){var e=t.message,o=t.blockingErrorMessage;if(this.errorFunction){var r="";"object"===I(e)&&(e.faultstring?r=e.faultstring:Object.keys(e).reverse().forEach((function(t){r+="".concat(e[t],"<br/>")})));var n=r.length?r:JSON.stringify(e);this.errorFunction(n,"Ошибка")}else{if(o)throw new Error(o);console.log(e)}}},{key:"handleSuccess",value:function(t){this.successFunction&&this.successFunction(t)}},{key:"request",value:function(t){var e=t.requestPath,o=t.requestBody,r={method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRFToken":this.token},body:JSON.stringify(o)};return fetch("/api/v2/vision/".concat(e,"/"),r)}},{key:"getPhotos",value:function(){var t={};return this.employeeId&&!this.visionPersonId?t.employeeId=this.employeeId:this.visionPersonId?t.vision_person_id=this.visionPersonId:this.personId&&(t.personId=this.personId),this.request({requestPath:"get_photos",requestBody:k(k({},t),{},{masterAlbum:this.masterAlbum})})}},{key:"addPhoto",value:function(t){return this.toggleOverlayMessage("Загрузка..."),this.request({requestPath:"add_photo",requestBody:{employeeId:this.employeeId,image:t}})}},{key:"deletePhoto",value:function(t){this.toggleOverlayMessage("Удаление фотографии...");var e=this.employeeId;return this.request({requestPath:"delete_photo",requestBody:{employee_id:e,photo_id:t}})}},{key:"updatePhoto",value:function(t){return this.toggleOverlayMessage("Обновление фотографии..."),this.request({requestPath:"update_photo",requestBody:{employeeId:this.employeeId,photo_id:t}})}},{key:"setAsMainPhoto",value:function(t){return this.toggleOverlayMessage("Обновление основной фотографии..."),this.request({requestPath:"set_main_photo",requestBody:{employeeId:this.employeeId,photoId:t}})}},{key:"toggleOverlayMessage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.galleryContainer;if(!e)throw new Error("Не найдена корневой элемент галереи");t?(e.dataset.message=t,e.classList.add("vision-photo-gallery--message")):(e.classList.remove("vision-photo-gallery--message"),e.dataset.message="")}},{key:"draw",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=this.rootElement;o.innerHTML='\n      <div class="vision-photo-gallery">\n        <input type="file" class="vision-photo-gallery__file-field" tabindex="-1">\n        <div class="vision-photo-gallery__item vision-photo-gallery__item--main">\n          <div class="vg-main-photo"></div>\n        </div>\n        <div class="vision-photo-gallery__item">\n          <div class="vg-gallery"></div>\n        </div>\n      </div>\n    ';var r=document.querySelector(".vision-photo-gallery");this.galleryContainer=r,this.toggleOverlayMessage("Загрузка...");var n=o.querySelector(".vg-main-photo"),i=o.querySelector(".vg-gallery"),s=this.controls.upload;this.getPhotos().then((function(e){if(n.innerHTML=t.createPhotoElement({main:!0,empty:!0,photoId:null}),s&&(i.innerHTML=t.createPhotoElement({main:!1,empty:!0,photoId:null})),e.ok)return e.json();n.innerHTML=t.createNoPhotoElement(),t.initEvents(),t.toggleOverlayMessage()}),(function(e){t.toggleOverlayMessage(),t.handleError({message:e}),t.initEvents()})).then((function(o){var r={action:e.action,photos:o};if(!o||!o.length)return n.innerHTML=t.createNoPhotoElement(),i.parentElement.classList.add("hidden"),t.toggleOverlayMessage(),void("photoRemoveMain"===e.action&&t.handleSuccess(r));var a=o.find((function(t){return t.main})),u=o.filter((function(t){return!t.main}));if(a?n.innerHTML=t.createPhotoElement(a):n.parentElement.classList.add("hidden"),u.length){var l="";u.forEach((function(e){return l+=t.createPhotoElement(e)})),s&&(l+=t.createPhotoElement({main:!1,empty:!0,photoId:null})),i.innerHTML=l}else s||i.parentElement.classList.add("hidden");t.initEvents(),t.toggleOverlayMessage(),t.handleSuccess(r)}),(function(e){t.handleError({message:e}),t.toggleOverlayMessage(),t.initEvents()})).catch((function(e){t.toggleOverlayMessage(),t.handleError({message:e}),t.initEvents()})),this.initEvents()}},{key:"createPhotoElement",value:function(t){var e=t.photoId,o=t.main,r=t.empty,n=t.path,i=t.avatarUrl,s=this.controls,a=s.disableAll,u=s.upload,l=s.update,h=s.remove,c=void 0===h?!r:h,d="",f="",p="",y="";return!i&&n&&(p='style="background-image: url('.concat(n,')"')),i&&(p='style="background-image: url('.concat(i,')"')),o?(y='data-main="'.concat(o,'"'),r?(f="vg-photo vg-photo--main",d=this.getPhotoButtons({upload:u})):(f="vg-photo vg-photo--main",d=this.getPhotoButtons({remove:c}))):r?(f="vg-gallery__item vg-photo vg-photo--upload",d=this.getPhotoButtons({uploadIcon:u})):(f="vg-gallery__item vg-photo",d=this.getPhotoButtons({update:l,remove:c})),'\n      <div class="'.concat(f,'"\n        ').concat(p,'\n        data-photo-id="').concat(e,'"\n        ').concat(y,">\n        ").concat(a?"":d,"\n        </div>\n      ")}},{key:"createNoPhotoElement",value:function(){return'\n      <div class="vg-photo vg-photo--main">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="-256 -256 1024 1024">\n          <path fill="#4a5266"\n            d="M437 310.8c-28.4-28.4-62.2-49.2-99.1-61.7 34.1-25.2 56.2-65.6 56.2-111.1C394.1 61.9 332.1 0 256 0S117.9 61.9 117.9 138.1c0 45.5 22.1 85.9 56.2 111.1 -36.9 12.4-70.8 33.3-99.1 61.7C26.6 359.2 0 423.5 0 491.8 0 503 9 512 20.2 512h471.7c11.1 0 20.2-9 20.2-20.2C512 423.5 485.4 359.2 437 310.8zM158.2 138.1c0-53.9 43.9-97.8 97.8-97.8 53.9 0 97.8 43.9 97.8 97.8 0 53.9-43.9 97.8-97.8 97.8C202.1 235.8 158.2 192 158.2 138.1zM41.2 471.7C51.4 362.2 143.9 276.2 256 276.2s204.6 86 214.8 195.5H41.2z"/>\n        </svg>\n      </div>\n    '}},{key:"getPhotoButtons",value:function(t){if(t.disableAll)return"";var e={remove:'<button class="vg-photo__button vg-button vg-button--red" data-action="remove-photo">Удалить</button>',upload:'<button class="vg-photo__button vg-button" data-action="upload-photo">Загрузить</button>',uploadIcon:'<button class="vg-photo__button vg-button vg-button--upload" data-action="upload-photo">&#43;</button>',update:'<button class="vg-photo__button vg-button vg-button--green" data-action="update-photo">Выбрать</button>'};return Object.keys(t).reduce((function(o,r){return t[r]&&(o+=e[r]),o}),"")}},{key:"initEvents",value:function(){var t=this;this.rootElement.querySelectorAll("button").forEach((function(e){e.addEventListener("click",t.router[e.dataset.action],!1)}))}}],o&&B(e.prototype,o),t}();return e.default}()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FDZHpCLE9BQVEsd0dBQ1JELE9BQVEsMkZBQ1JrRixXQUFZLHlHQUNabkYsT0FBUSwyR0FHVixPQUFPMUwsT0FBT3lHLEtBQUt1SCxHQUFROEMsUUFBTyxTQUFDQyxFQUFlalIsR0FLaEQsT0FKSWtPLEVBQU9sTyxLQUNUaVIsR0FBaUIxRCxFQUFRdk4sSUFHcEJpUixJQUNOLE0sd0JBTUwsV0FBYSxXQUNXcFIsS0FBZm9NLFlBQ3FCdUIsaUJBQWlCLFVBRXJDOUssU0FBUSxTQUFBK0ssR0FDZEEsRUFBTzVDLGlCQUNMLFFBQ0EsRUFBS3NCLE9BQU9zQixFQUFPUCxRQUFRTCxTQUMzQixTLHNCQS9wQmF6QixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vVmlzaW9uUGhvdG9HYWxsZXJ5L3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9WaXNpb25QaG90b0dhbGxlcnkvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vVmlzaW9uUGhvdG9HYWxsZXJ5L3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9WaXNpb25QaG90b0dhbGxlcnkvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9WaXNpb25QaG90b0dhbGxlcnkvLi9ub2RlX21vZHVsZXMvd2hhdHdnLWZldGNoL2ZldGNoLmpzIiwid2VicGFjazovL1Zpc2lvblBob3RvR2FsbGVyeS8uL1Zpc2lvblBob3RvR2FsbGVyeS9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJWaXNpb25QaG90b0dhbGxlcnlcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiVmlzaW9uUGhvdG9HYWxsZXJ5XCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsInZhciBnbG9iYWwgPVxuICAodHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnICYmIGdsb2JhbFRoaXMpIHx8XG4gICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgc2VsZikgfHxcbiAgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnICYmIGdsb2JhbClcblxudmFyIHN1cHBvcnQgPSB7XG4gIHNlYXJjaFBhcmFtczogJ1VSTFNlYXJjaFBhcmFtcycgaW4gZ2xvYmFsLFxuICBpdGVyYWJsZTogJ1N5bWJvbCcgaW4gZ2xvYmFsICYmICdpdGVyYXRvcicgaW4gU3ltYm9sLFxuICBibG9iOlxuICAgICdGaWxlUmVhZGVyJyBpbiBnbG9iYWwgJiZcbiAgICAnQmxvYicgaW4gZ2xvYmFsICYmXG4gICAgKGZ1bmN0aW9uKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbmV3IEJsb2IoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9KSgpLFxuICBmb3JtRGF0YTogJ0Zvcm1EYXRhJyBpbiBnbG9iYWwsXG4gIGFycmF5QnVmZmVyOiAnQXJyYXlCdWZmZXInIGluIGdsb2JhbFxufVxuXG5mdW5jdGlvbiBpc0RhdGFWaWV3KG9iaikge1xuICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbn1cblxuaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIpIHtcbiAgdmFyIHZpZXdDbGFzc2VzID0gW1xuICAgICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQ4QXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50OENsYW1wZWRBcnJheV0nLFxuICAgICdbb2JqZWN0IEludDE2QXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50MTZBcnJheV0nLFxuICAgICdbb2JqZWN0IEludDMyQXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IEZsb2F0MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IEZsb2F0NjRBcnJheV0nXG4gIF1cblxuICB2YXIgaXNBcnJheUJ1ZmZlclZpZXcgPVxuICAgIEFycmF5QnVmZmVyLmlzVmlldyB8fFxuICAgIGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIG9iaiAmJiB2aWV3Q2xhc3Nlcy5pbmRleE9mKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopKSA+IC0xXG4gICAgfVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykge1xuICAgIG5hbWUgPSBTdHJpbmcobmFtZSlcbiAgfVxuICBpZiAoL1teYS16MC05XFwtIyQlJicqKy5eX2B8fiFdL2kudGVzdChuYW1lKSB8fCBuYW1lID09PSAnJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgY2hhcmFjdGVyIGluIGhlYWRlciBmaWVsZCBuYW1lOiBcIicgKyBuYW1lICsgJ1wiJylcbiAgfVxuICByZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpXG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVZhbHVlKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgdmFsdWUgPSBTdHJpbmcodmFsdWUpXG4gIH1cbiAgcmV0dXJuIHZhbHVlXG59XG5cbi8vIEJ1aWxkIGEgZGVzdHJ1Y3RpdmUgaXRlcmF0b3IgZm9yIHRoZSB2YWx1ZSBsaXN0XG5mdW5jdGlvbiBpdGVyYXRvckZvcihpdGVtcykge1xuICB2YXIgaXRlcmF0b3IgPSB7XG4gICAgbmV4dDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgdmFsdWUgPSBpdGVtcy5zaGlmdCgpXG4gICAgICByZXR1cm4ge2RvbmU6IHZhbHVlID09PSB1bmRlZmluZWQsIHZhbHVlOiB2YWx1ZX1cbiAgICB9XG4gIH1cblxuICBpZiAoc3VwcG9ydC5pdGVyYWJsZSkge1xuICAgIGl0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpdGVyYXRvclxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBpdGVyYXRvclxufVxuXG5leHBvcnQgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gIHRoaXMubWFwID0ge31cblxuICBpZiAoaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMpIHtcbiAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgIHRoaXMuYXBwZW5kKG5hbWUsIHZhbHVlKVxuICAgIH0sIHRoaXMpXG4gIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXJzKSkge1xuICAgIGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbihoZWFkZXIpIHtcbiAgICAgIHRoaXMuYXBwZW5kKGhlYWRlclswXSwgaGVhZGVyWzFdKVxuICAgIH0sIHRoaXMpXG4gIH0gZWxzZSBpZiAoaGVhZGVycykge1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGhlYWRlcnMpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICB9LCB0aGlzKVxuICB9XG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIG5hbWUgPSBub3JtYWxpemVOYW1lKG5hbWUpXG4gIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gIHZhciBvbGRWYWx1ZSA9IHRoaXMubWFwW25hbWVdXG4gIHRoaXMubWFwW25hbWVdID0gb2xkVmFsdWUgPyBvbGRWYWx1ZSArICcsICcgKyB2YWx1ZSA6IHZhbHVlXG59XG5cbkhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgZGVsZXRlIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSlcbiAgcmV0dXJuIHRoaXMuaGFzKG5hbWUpID8gdGhpcy5tYXBbbmFtZV0gOiBudWxsXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMubWFwLmhhc093blByb3BlcnR5KG5vcm1hbGl6ZU5hbWUobmFtZSkpXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbihjYWxsYmFjaywgdGhpc0FyZykge1xuICBmb3IgKHZhciBuYW1lIGluIHRoaXMubWFwKSB7XG4gICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHRoaXMubWFwW25hbWVdLCBuYW1lLCB0aGlzKVxuICAgIH1cbiAgfVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5rZXlzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgIGl0ZW1zLnB1c2gobmFtZSlcbiAgfSlcbiAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGl0ZW1zID0gW11cbiAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaXRlbXMucHVzaCh2YWx1ZSlcbiAgfSlcbiAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxufVxuXG5IZWFkZXJzLnByb3RvdHlwZS5lbnRyaWVzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpdGVtcyA9IFtdXG4gIHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgIGl0ZW1zLnB1c2goW25hbWUsIHZhbHVlXSlcbiAgfSlcbiAgcmV0dXJuIGl0ZXJhdG9yRm9yKGl0ZW1zKVxufVxuXG5pZiAoc3VwcG9ydC5pdGVyYWJsZSkge1xuICBIZWFkZXJzLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gSGVhZGVycy5wcm90b3R5cGUuZW50cmllc1xufVxuXG5mdW5jdGlvbiBjb25zdW1lZChib2R5KSB7XG4gIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpKVxuICB9XG4gIGJvZHkuYm9keVVzZWQgPSB0cnVlXG59XG5cbmZ1bmN0aW9uIGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlc29sdmUocmVhZGVyLnJlc3VsdClcbiAgICB9XG4gICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlamVjdChyZWFkZXIuZXJyb3IpXG4gICAgfVxuICB9KVxufVxuXG5mdW5jdGlvbiByZWFkQmxvYkFzQXJyYXlCdWZmZXIoYmxvYikge1xuICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICByZXR1cm4gcHJvbWlzZVxufVxuXG5mdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7XG4gIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gIHZhciBwcm9taXNlID0gZmlsZVJlYWRlclJlYWR5KHJlYWRlcilcbiAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuZnVuY3Rpb24gcmVhZEFycmF5QnVmZmVyQXNUZXh0KGJ1Zikge1xuICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZilcbiAgdmFyIGNoYXJzID0gbmV3IEFycmF5KHZpZXcubGVuZ3RoKVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgIGNoYXJzW2ldID0gU3RyaW5nLmZyb21DaGFyQ29kZSh2aWV3W2ldKVxuICB9XG4gIHJldHVybiBjaGFycy5qb2luKCcnKVxufVxuXG5mdW5jdGlvbiBidWZmZXJDbG9uZShidWYpIHtcbiAgaWYgKGJ1Zi5zbGljZSkge1xuICAgIHJldHVybiBidWYuc2xpY2UoMClcbiAgfSBlbHNlIHtcbiAgICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zi5ieXRlTGVuZ3RoKVxuICAgIHZpZXcuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZikpXG4gICAgcmV0dXJuIHZpZXcuYnVmZmVyXG4gIH1cbn1cblxuZnVuY3Rpb24gQm9keSgpIHtcbiAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cbiAgdGhpcy5faW5pdEJvZHkgPSBmdW5jdGlvbihib2R5KSB7XG4gICAgLypcbiAgICAgIGZldGNoLW1vY2sgd3JhcHMgdGhlIFJlc3BvbnNlIG9iamVjdCBpbiBhbiBFUzYgUHJveHkgdG9cbiAgICAgIHByb3ZpZGUgdXNlZnVsIHRlc3QgaGFybmVzcyBmZWF0dXJlcyBzdWNoIGFzIGZsdXNoLiBIb3dldmVyLCBvblxuICAgICAgRVM1IGJyb3dzZXJzIHdpdGhvdXQgZmV0Y2ggb3IgUHJveHkgc3VwcG9ydCBwb2xseWZpbGxzIG11c3QgYmUgdXNlZDtcbiAgICAgIHRoZSBwcm94eS1wb2xseWZpbGwgaXMgdW5hYmxlIHRvIHByb3h5IGFuIGF0dHJpYnV0ZSB1bmxlc3MgaXQgZXhpc3RzXG4gICAgICBvbiB0aGUgb2JqZWN0IGJlZm9yZSB0aGUgUHJveHkgaXMgY3JlYXRlZC4gVGhpcyBjaGFuZ2UgZW5zdXJlc1xuICAgICAgUmVzcG9uc2UuYm9keVVzZWQgZXhpc3RzIG9uIHRoZSBpbnN0YW5jZSwgd2hpbGUgbWFpbnRhaW5pbmcgdGhlXG4gICAgICBzZW1hbnRpYyBvZiBzZXR0aW5nIFJlcXVlc3QuYm9keVVzZWQgaW4gdGhlIGNvbnN0cnVjdG9yIGJlZm9yZVxuICAgICAgX2luaXRCb2R5IGlzIGNhbGxlZC5cbiAgICAqL1xuICAgIHRoaXMuYm9keVVzZWQgPSB0aGlzLmJvZHlVc2VkXG4gICAgdGhpcy5fYm9keUluaXQgPSBib2R5XG4gICAgaWYgKCFib2R5KSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9ICcnXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5ibG9iICYmIEJsb2IucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlCbG9iID0gYm9keVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgdGhpcy5fYm9keUZvcm1EYXRhID0gYm9keVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5zZWFyY2hQYXJhbXMgJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkudG9TdHJpbmcoKVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlciAmJiBzdXBwb3J0LmJsb2IgJiYgaXNEYXRhVmlldyhib2R5KSkge1xuICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keS5idWZmZXIpXG4gICAgICAvLyBJRSAxMC0xMSBjYW4ndCBoYW5kbGUgYSBEYXRhVmlldyBib2R5LlxuICAgICAgdGhpcy5fYm9keUluaXQgPSBuZXcgQmxvYihbdGhpcy5fYm9keUFycmF5QnVmZmVyXSlcbiAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIgJiYgKEFycmF5QnVmZmVyLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpIHx8IGlzQXJyYXlCdWZmZXJWaWV3KGJvZHkpKSkge1xuICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5ID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGJvZHkpXG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKSkge1xuICAgICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCAndGV4dC9wbGFpbjtjaGFyc2V0PVVURi04JylcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUJsb2IgJiYgdGhpcy5fYm9keUJsb2IudHlwZSkge1xuICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCB0aGlzLl9ib2R5QmxvYi50eXBlKVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LnNlYXJjaFBhcmFtcyAmJiBVUkxTZWFyY2hQYXJhbXMucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzLnNldCgnY29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04JylcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgdGhpcy5ibG9iID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKVxuICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5QmxvYilcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKVxuICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIGJsb2InKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQmxvYihbdGhpcy5fYm9keVRleHRdKSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHZhciBpc0NvbnN1bWVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgaWYgKGlzQ29uc3VtZWQpIHtcbiAgICAgICAgICByZXR1cm4gaXNDb25zdW1lZFxuICAgICAgICB9XG4gICAgICAgIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcodGhpcy5fYm9keUFycmF5QnVmZmVyKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoXG4gICAgICAgICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIuYnVmZmVyLnNsaWNlKFxuICAgICAgICAgICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIuYnl0ZU9mZnNldCxcbiAgICAgICAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyLmJ5dGVPZmZzZXQgKyB0aGlzLl9ib2R5QXJyYXlCdWZmZXIuYnl0ZUxlbmd0aFxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcilcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmxvYigpLnRoZW4ocmVhZEJsb2JBc0FycmF5QnVmZmVyKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZWFkQXJyYXlCdWZmZXJBc1RleHQodGhpcy5fYm9keUFycmF5QnVmZmVyKSlcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIHRleHQnKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdXBwb3J0LmZvcm1EYXRhKSB7XG4gICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oZGVjb2RlKVxuICAgIH1cbiAgfVxuXG4gIHRoaXMuanNvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnRleHQoKS50aGVuKEpTT04ucGFyc2UpXG4gIH1cblxuICByZXR1cm4gdGhpc1xufVxuXG4vLyBIVFRQIG1ldGhvZHMgd2hvc2UgY2FwaXRhbGl6YXRpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWRcbnZhciBtZXRob2RzID0gWydERUxFVEUnLCAnR0VUJywgJ0hFQUQnLCAnT1BUSU9OUycsICdQT1NUJywgJ1BVVCddXG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZU1ldGhvZChtZXRob2QpIHtcbiAgdmFyIHVwY2FzZWQgPSBtZXRob2QudG9VcHBlckNhc2UoKVxuICByZXR1cm4gbWV0aG9kcy5pbmRleE9mKHVwY2FzZWQpID4gLTEgPyB1cGNhc2VkIDogbWV0aG9kXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBSZXF1ZXN0KGlucHV0LCBvcHRpb25zKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBSZXF1ZXN0KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1BsZWFzZSB1c2UgdGhlIFwibmV3XCIgb3BlcmF0b3IsIHRoaXMgRE9NIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uJylcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gIHZhciBib2R5ID0gb3B0aW9ucy5ib2R5XG5cbiAgaWYgKGlucHV0IGluc3RhbmNlb2YgUmVxdWVzdCkge1xuICAgIGlmIChpbnB1dC5ib2R5VXNlZCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJylcbiAgICB9XG4gICAgdGhpcy51cmwgPSBpbnB1dC51cmxcbiAgICB0aGlzLmNyZWRlbnRpYWxzID0gaW5wdXQuY3JlZGVudGlhbHNcbiAgICBpZiAoIW9wdGlvbnMuaGVhZGVycykge1xuICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMoaW5wdXQuaGVhZGVycylcbiAgICB9XG4gICAgdGhpcy5tZXRob2QgPSBpbnB1dC5tZXRob2RcbiAgICB0aGlzLm1vZGUgPSBpbnB1dC5tb2RlXG4gICAgdGhpcy5zaWduYWwgPSBpbnB1dC5zaWduYWxcbiAgICBpZiAoIWJvZHkgJiYgaW5wdXQuX2JvZHlJbml0ICE9IG51bGwpIHtcbiAgICAgIGJvZHkgPSBpbnB1dC5fYm9keUluaXRcbiAgICAgIGlucHV0LmJvZHlVc2VkID0gdHJ1ZVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLnVybCA9IFN0cmluZyhpbnB1dClcbiAgfVxuXG4gIHRoaXMuY3JlZGVudGlhbHMgPSBvcHRpb25zLmNyZWRlbnRpYWxzIHx8IHRoaXMuY3JlZGVudGlhbHMgfHwgJ3NhbWUtb3JpZ2luJ1xuICBpZiAob3B0aW9ucy5oZWFkZXJzIHx8ICF0aGlzLmhlYWRlcnMpIHtcbiAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gIH1cbiAgdGhpcy5tZXRob2QgPSBub3JtYWxpemVNZXRob2Qob3B0aW9ucy5tZXRob2QgfHwgdGhpcy5tZXRob2QgfHwgJ0dFVCcpXG4gIHRoaXMubW9kZSA9IG9wdGlvbnMubW9kZSB8fCB0aGlzLm1vZGUgfHwgbnVsbFxuICB0aGlzLnNpZ25hbCA9IG9wdGlvbnMuc2lnbmFsIHx8IHRoaXMuc2lnbmFsXG4gIHRoaXMucmVmZXJyZXIgPSBudWxsXG5cbiAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgYm9keSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JvZHkgbm90IGFsbG93ZWQgZm9yIEdFVCBvciBIRUFEIHJlcXVlc3RzJylcbiAgfVxuICB0aGlzLl9pbml0Qm9keShib2R5KVxuXG4gIGlmICh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykge1xuICAgIGlmIChvcHRpb25zLmNhY2hlID09PSAnbm8tc3RvcmUnIHx8IG9wdGlvbnMuY2FjaGUgPT09ICduby1jYWNoZScpIHtcbiAgICAgIC8vIFNlYXJjaCBmb3IgYSAnXycgcGFyYW1ldGVyIGluIHRoZSBxdWVyeSBzdHJpbmdcbiAgICAgIHZhciByZVBhcmFtU2VhcmNoID0gLyhbPyZdKV89W14mXSovXG4gICAgICBpZiAocmVQYXJhbVNlYXJjaC50ZXN0KHRoaXMudXJsKSkge1xuICAgICAgICAvLyBJZiBpdCBhbHJlYWR5IGV4aXN0cyB0aGVuIHNldCB0aGUgdmFsdWUgd2l0aCB0aGUgY3VycmVudCB0aW1lXG4gICAgICAgIHRoaXMudXJsID0gdGhpcy51cmwucmVwbGFjZShyZVBhcmFtU2VhcmNoLCAnJDFfPScgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSBhZGQgYSBuZXcgJ18nIHBhcmFtZXRlciB0byB0aGUgZW5kIHdpdGggdGhlIGN1cnJlbnQgdGltZVxuICAgICAgICB2YXIgcmVRdWVyeVN0cmluZyA9IC9cXD8vXG4gICAgICAgIHRoaXMudXJsICs9IChyZVF1ZXJ5U3RyaW5nLnRlc3QodGhpcy51cmwpID8gJyYnIDogJz8nKSArICdfPScgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5SZXF1ZXN0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywge2JvZHk6IHRoaXMuX2JvZHlJbml0fSlcbn1cblxuZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgdmFyIGZvcm0gPSBuZXcgRm9ybURhdGEoKVxuICBib2R5XG4gICAgLnRyaW0oKVxuICAgIC5zcGxpdCgnJicpXG4gICAgLmZvckVhY2goZnVuY3Rpb24oYnl0ZXMpIHtcbiAgICAgIGlmIChieXRlcykge1xuICAgICAgICB2YXIgc3BsaXQgPSBieXRlcy5zcGxpdCgnPScpXG4gICAgICAgIHZhciBuYW1lID0gc3BsaXQuc2hpZnQoKS5yZXBsYWNlKC9cXCsvZywgJyAnKVxuICAgICAgICB2YXIgdmFsdWUgPSBzcGxpdC5qb2luKCc9JykucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgZm9ybS5hcHBlbmQoZGVjb2RlVVJJQ29tcG9uZW50KG5hbWUpLCBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpKVxuICAgICAgfVxuICAgIH0pXG4gIHJldHVybiBmb3JtXG59XG5cbmZ1bmN0aW9uIHBhcnNlSGVhZGVycyhyYXdIZWFkZXJzKSB7XG4gIHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKVxuICAvLyBSZXBsYWNlIGluc3RhbmNlcyBvZiBcXHJcXG4gYW5kIFxcbiBmb2xsb3dlZCBieSBhdCBsZWFzdCBvbmUgc3BhY2Ugb3IgaG9yaXpvbnRhbCB0YWIgd2l0aCBhIHNwYWNlXG4gIC8vIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM3MjMwI3NlY3Rpb24tMy4yXG4gIHZhciBwcmVQcm9jZXNzZWRIZWFkZXJzID0gcmF3SGVhZGVycy5yZXBsYWNlKC9cXHI/XFxuW1xcdCBdKy9nLCAnICcpXG4gIC8vIEF2b2lkaW5nIHNwbGl0IHZpYSByZWdleCB0byB3b3JrIGFyb3VuZCBhIGNvbW1vbiBJRTExIGJ1ZyB3aXRoIHRoZSBjb3JlLWpzIDMuNi4wIHJlZ2V4IHBvbHlmaWxsXG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9naXRodWIvZmV0Y2gvaXNzdWVzLzc0OFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvNzUxXG4gIHByZVByb2Nlc3NlZEhlYWRlcnNcbiAgICAuc3BsaXQoJ1xccicpXG4gICAgLm1hcChmdW5jdGlvbihoZWFkZXIpIHtcbiAgICAgIHJldHVybiBoZWFkZXIuaW5kZXhPZignXFxuJykgPT09IDAgPyBoZWFkZXIuc3Vic3RyKDEsIGhlYWRlci5sZW5ndGgpIDogaGVhZGVyXG4gICAgfSlcbiAgICAuZm9yRWFjaChmdW5jdGlvbihsaW5lKSB7XG4gICAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCc6JylcbiAgICAgIHZhciBrZXkgPSBwYXJ0cy5zaGlmdCgpLnRyaW0oKVxuICAgICAgaWYgKGtleSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBwYXJ0cy5qb2luKCc6JykudHJpbSgpXG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKGtleSwgdmFsdWUpXG4gICAgICB9XG4gICAgfSlcbiAgcmV0dXJuIGhlYWRlcnNcbn1cblxuQm9keS5jYWxsKFJlcXVlc3QucHJvdG90eXBlKVxuXG5leHBvcnQgZnVuY3Rpb24gUmVzcG9uc2UoYm9keUluaXQsIG9wdGlvbnMpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJlc3BvbnNlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1BsZWFzZSB1c2UgdGhlIFwibmV3XCIgb3BlcmF0b3IsIHRoaXMgRE9NIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uJylcbiAgfVxuICBpZiAoIW9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0ge31cbiAgfVxuXG4gIHRoaXMudHlwZSA9ICdkZWZhdWx0J1xuICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzID09PSB1bmRlZmluZWQgPyAyMDAgOiBvcHRpb25zLnN0YXR1c1xuICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gIHRoaXMuc3RhdHVzVGV4dCA9IG9wdGlvbnMuc3RhdHVzVGV4dCA9PT0gdW5kZWZpbmVkID8gJycgOiAnJyArIG9wdGlvbnMuc3RhdHVzVGV4dFxuICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpXG59XG5cbkJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cblJlc3BvbnNlLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKHRoaXMuX2JvZHlJbml0LCB7XG4gICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICBzdGF0dXNUZXh0OiB0aGlzLnN0YXR1c1RleHQsXG4gICAgaGVhZGVyczogbmV3IEhlYWRlcnModGhpcy5oZWFkZXJzKSxcbiAgICB1cmw6IHRoaXMudXJsXG4gIH0pXG59XG5cblJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gIHZhciByZXNwb25zZSA9IG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiAwLCBzdGF0dXNUZXh0OiAnJ30pXG4gIHJlc3BvbnNlLnR5cGUgPSAnZXJyb3InXG4gIHJldHVybiByZXNwb25zZVxufVxuXG52YXIgcmVkaXJlY3RTdGF0dXNlcyA9IFszMDEsIDMwMiwgMzAzLCAzMDcsIDMwOF1cblxuUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICBpZiAocmVkaXJlY3RTdGF0dXNlcy5pbmRleE9mKHN0YXR1cykgPT09IC0xKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgc3RhdHVzIGNvZGUnKVxuICB9XG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiBzdGF0dXMsIGhlYWRlcnM6IHtsb2NhdGlvbjogdXJsfX0pXG59XG5cbmV4cG9ydCB2YXIgRE9NRXhjZXB0aW9uID0gZ2xvYmFsLkRPTUV4Y2VwdGlvblxudHJ5IHtcbiAgbmV3IERPTUV4Y2VwdGlvbigpXG59IGNhdGNoIChlcnIpIHtcbiAgRE9NRXhjZXB0aW9uID0gZnVuY3Rpb24obWVzc2FnZSwgbmFtZSkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2VcbiAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgdmFyIGVycm9yID0gRXJyb3IobWVzc2FnZSlcbiAgICB0aGlzLnN0YWNrID0gZXJyb3Iuc3RhY2tcbiAgfVxuICBET01FeGNlcHRpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpXG4gIERPTUV4Y2VwdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBET01FeGNlcHRpb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZldGNoKGlucHV0LCBpbml0KSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuXG4gICAgaWYgKHJlcXVlc3Quc2lnbmFsICYmIHJlcXVlc3Quc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgIHJldHVybiByZWplY3QobmV3IERPTUV4Y2VwdGlvbignQWJvcnRlZCcsICdBYm9ydEVycm9yJykpXG4gICAgfVxuXG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpXG5cbiAgICBmdW5jdGlvbiBhYm9ydFhocigpIHtcbiAgICAgIHhoci5hYm9ydCgpXG4gICAgfVxuXG4gICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIHN0YXR1czogeGhyLnN0YXR1cyxcbiAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHQsXG4gICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICB9XG4gICAgICBvcHRpb25zLnVybCA9ICdyZXNwb25zZVVSTCcgaW4geGhyID8geGhyLnJlc3BvbnNlVVJMIDogb3B0aW9ucy5oZWFkZXJzLmdldCgnWC1SZXF1ZXN0LVVSTCcpXG4gICAgICB2YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dFxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZShuZXcgUmVzcG9uc2UoYm9keSwgb3B0aW9ucykpXG4gICAgICB9LCAwKVxuICAgIH1cblxuICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgfSwgMClcbiAgICB9XG5cbiAgICB4aHIub250aW1lb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgfSwgMClcbiAgICB9XG5cbiAgICB4aHIub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBET01FeGNlcHRpb24oJ0Fib3J0ZWQnLCAnQWJvcnRFcnJvcicpKVxuICAgICAgfSwgMClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaXhVcmwodXJsKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gdXJsID09PSAnJyAmJiBnbG9iYWwubG9jYXRpb24uaHJlZiA/IGdsb2JhbC5sb2NhdGlvbi5ocmVmIDogdXJsXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiB1cmxcbiAgICAgIH1cbiAgICB9XG5cbiAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgZml4VXJsKHJlcXVlc3QudXJsKSwgdHJ1ZSlcblxuICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlXG4gICAgfSBlbHNlIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnb21pdCcpIHtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZVxuICAgIH1cblxuICAgIGlmICgncmVzcG9uc2VUeXBlJyBpbiB4aHIpIHtcbiAgICAgIGlmIChzdXBwb3J0LmJsb2IpIHtcbiAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgc3VwcG9ydC5hcnJheUJ1ZmZlciAmJlxuICAgICAgICByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdDb250ZW50LVR5cGUnKSAmJlxuICAgICAgICByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdDb250ZW50LVR5cGUnKS5pbmRleE9mKCdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nKSAhPT0gLTFcbiAgICAgICkge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2FycmF5YnVmZmVyJ1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpbml0ICYmIHR5cGVvZiBpbml0LmhlYWRlcnMgPT09ICdvYmplY3QnICYmICEoaW5pdC5oZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycykpIHtcbiAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGluaXQuaGVhZGVycykuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIG5vcm1hbGl6ZVZhbHVlKGluaXQuaGVhZGVyc1tuYW1lXSkpXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICByZXF1ZXN0LmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3Quc2lnbmFsKSB7XG4gICAgICByZXF1ZXN0LnNpZ25hbC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGFib3J0WGhyKVxuXG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIERPTkUgKHN1Y2Nlc3Mgb3IgZmFpbHVyZSlcbiAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgcmVxdWVzdC5zaWduYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBhYm9ydFhocilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHhoci5zZW5kKHR5cGVvZiByZXF1ZXN0Ll9ib2R5SW5pdCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogcmVxdWVzdC5fYm9keUluaXQpXG4gIH0pXG59XG5cbmZldGNoLnBvbHlmaWxsID0gdHJ1ZVxuXG5pZiAoIWdsb2JhbC5mZXRjaCkge1xuICBnbG9iYWwuZmV0Y2ggPSBmZXRjaFxuICBnbG9iYWwuSGVhZGVycyA9IEhlYWRlcnNcbiAgZ2xvYmFsLlJlcXVlc3QgPSBSZXF1ZXN0XG4gIGdsb2JhbC5SZXNwb25zZSA9IFJlc3BvbnNlXG59XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IFwiLi9hcHAuc2Nzc1wiO1xuaW1wb3J0ICd3aGF0d2ctZmV0Y2gnO1xuXG4vKipcbiAqINCa0LvQsNGB0YEg0LPQsNC70LXRgNC10LguXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZpc2lvblBob3RvR2FsbGVyeSB7XG4gIGdhbGxlcnlDb250YWluZXIgPSBudWxsO1xuICByb290RWxlbWVudCA9IG51bGw7XG4gIHRva2VuID0gbnVsbDtcbiAgY29udHJvbHMgPSB7XG4gICAgZGlzYWJsZUFsbDogZmFsc2UsXG4gICAgdXBkYXRlOiB0cnVlLFxuICAgIHVwbG9hZDogdHJ1ZSxcbiAgICByZW1vdmU6IHRydWVcbiAgfTtcbiAgbWFzdGVyQWxidW0gPSB0cnVlO1xuXG4gIC8qKlxuICAgKiDQmtC+0L3RgdGC0YDRg9C60YLQvtGAINGN0LrQt9C10LzQv9C70Y/RgNCwINC60LvQsNGB0YHQsCDQs9Cw0LvQtdGA0LXQuC5cbiAgICogQHBhcmFtIHJvb3Qge3N0cmluZ30gSUQg0LrQvtGA0L3QtdCy0L7Qs9C+INGN0LvQtdC80LXQvdGC0LAsINC60YPQtNCwINCx0YPQtNC10YIg0YDQtdC90LTQtdGA0LjRgtGM0YHRjyDQs9Cw0LvQtdGA0LXRjy5cbiAgICogQHBhcmFtIGVtcGxveWVlSWQge251bWJlcnxzdHJpbmd9IElEINGB0L7RgtGA0YPQtNC90LjQutCwLlxuICAgKiBAcGFyYW0gdmlzaW9uUGVyc29uSWQge251bWJlcnxzdHJpbmd9IElEINGB0L7RgtGA0YPQtNC90LjQutCwINCw0YPRgtGB0L7RgNGB0LXRgNCwLlxuICAgKiBAcGFyYW0gcGVyc29uSWQge251bWJlcnxzdHJpbmd9IElEINGB0L7RgtGA0YPQtNC90LjQutCwINCw0YPRgtGB0L7RgNGB0LXRgNCwLlxuICAgKiBAcGFyYW0gdG9rZW4ge3N0cmluZ30gQ1NSRi3RgtC+0LrQtdC9INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjy5cbiAgICogQHBhcmFtIGNvbnRyb2xzIHtvYmplY3R9INCd0LDRgdGC0YDQvtC50LrQsCDQvtGC0L7QsdGA0LDQttC10L3QuNGPINGN0LvQtdC80LXQvdGC0L7QsiDRg9C/0YDQsNCy0LvQtdC90LjRjy5cbiAgICogQHBhcmFtIGNvbnRyb2xzLmRpc2FibGVBbGwge2Jvb2xlYW59INCe0YLQutC70Y7Rh9C40YLRjCDQstGB0LUg0Y3Qu9C10LzQtdC90YLRiyDRg9C/0YDQsNCy0LvQtdC90LjRjy5cbiAgICogQHBhcmFtIGNvbnRyb2xzLnVwZGF0ZSB7Ym9vbGVhbn0g0J7RgtC+0LHRgNCw0LbQtdC90LjQtSDQutC90L7Qv9C60Lgg0L7QsdC90L7QstC70LXQvdC40Y8g0YTQvtGC0L7Qs9GA0LDRhNC40LggKNGD0YHRgtCw0L3QvtCy0LrQsCDQvtGB0L3QvtCy0L3QvtC5KS5cbiAgICogQHBhcmFtIGNvbnRyb2xzLnVwbG9hZCB7Ym9vbGVhbn0g0J7RgtC+0LHRgNCw0LbQtdC90LjQtSDQutC90L7Qv9C60Lgg0LfQsNCz0YDRg9C30LrQuCDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICogQHBhcmFtIGNvbnRyb2xzLnJlbW92ZSB7Ym9vbGVhbn0g0J7RgtC+0LHRgNCw0LbQtdC90LjQtSDQutC90L7Qv9C60Lgg0YPQtNCw0LvQtdC90LjRjyDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICogQHBhcmFtIG1hc3RlckFsYnVtIHtib29sZWFufSDQl9Cw0LPRgNGD0LfQutCwINGE0L7RgtC+0LPRgNCw0YTQuNC5INC40Lcg0LzQsNGB0YLQtdGALdCw0LvQsdC+0LzQsC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHtcbiAgICAgICAgICAgICAgICByb290LFxuICAgICAgICAgICAgICAgIGVtcGxveWVlSWQsXG4gICAgICAgICAgICAgICAgdmlzaW9uUGVyc29uSWQsXG4gICAgICAgICAgICAgICAgcGVyc29uSWQsXG4gICAgICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICAgICAgY29udHJvbHMsXG4gICAgICAgICAgICAgICAgbWFzdGVyQWxidW0gPSB0cnVlXG4gICAgICAgICAgICAgIH0pIHtcbiAgICBpZiAoIXJvb3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcItCd0LUg0YPQutCw0LfQsNC9IElEINC60L7RgNC90LXQstC+0LPQviDRjdC70LXQvNC10L3RgtCwINC00LvRjyDQs9Cw0LvQtdGA0LXQuCFcIik7XG4gICAgfVxuXG4gICAgY29uc3Qgcm9vdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyb290KTtcblxuICAgIGlmICghIXJvb3RFbGVtZW50KSB7XG4gICAgICB0aGlzLnJvb3RFbGVtZW50ID0gcm9vdEVsZW1lbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcItCf0YDQvtCy0LXRgNGM0YLQtSDRg9C60LDQt9Cw0L3QvdGL0LkgSUQg0LrQvtGA0L3QtdCy0L7Qs9C+INGN0LvQtdC80LXQvdGC0LAg0LTQu9GPINCz0LDQu9C10YDQtdC4IVwiKTtcbiAgICB9XG5cbiAgICBpZiAoIWVtcGxveWVlSWQgJiYgIXZpc2lvblBlcnNvbklkICYmICFwZXJzb25JZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwi0J3QtSDRg9C60LDQt9Cw0L0gSUQg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC90LAg0L/QvtGA0YLQsNC70LUgVmlzaW9uXCIpO1xuICAgIH1cblxuICAgIHRoaXMuZW1wbG95ZWUgPSB7XG4gICAgICBpZDogbnVsbCxcbiAgICAgIHBlcnNvbklkOiBudWxsLFxuICAgICAgdmlzaW9uUGVyc29uSWQ6IG51bGwsXG4gICAgfTtcblxuICAgIHRoaXMuZW1wbG95ZWVJZCA9IGVtcGxveWVlSWQ7XG4gICAgdGhpcy52aXNpb25QZXJzb25JZCA9IHZpc2lvblBlcnNvbklkO1xuICAgIHRoaXMucGVyc29uSWQgPSBwZXJzb25JZDtcbiAgICB0aGlzLnRva2VuID0gdG9rZW47XG4gICAgdGhpcy5jb250cm9scyA9IGNvbnRyb2xzO1xuICAgIHRoaXMubWFzdGVyQWxidW0gPSBtYXN0ZXJBbGJ1bTtcblxuICAgIHRoaXMuZHJhdygpO1xuICB9XG5cbiAgLyoqXG4gICAqINCd0LDQt9C90LDRh9Cw0LXQvNGL0Lkg0LzQtdGC0L7QtCDQtNC70Y8g0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQvtGI0LjQsdC+0LouXG4gICAqIEB0eXBlIHtudWxsfEZ1bmN0aW9ufSDQpNGD0L3QutGG0LjRjyDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQvtGC0L7QsdGA0LDQttC10L3QuNGPINC+0YjQuNCx0L7Qui5cbiAgICovXG4gIGVycm9yRnVuY3Rpb24gPSBudWxsO1xuICBzdWNjZXNzRnVuY3Rpb24gPSBudWxsO1xuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0LzQtdGC0L7QtNCwINC00LvRjyDQvtGC0L7QsdGA0LDQttC10L3QuNGPINC+0YjQuNCx0L7Qui5cbiAgICogQHR5cGUge251bGx8RnVuY3Rpb259INCk0YPQvdC60YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0L7RiNC40LHQvtC6LlxuICAgKi9cbiAgZ2V0IGVycm9yRnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZXJyb3JGdW5jdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiDQndCw0LfQvdCw0YfQtdC90LjQtSDQvNC10YLQvtC00LAg0LTQu9GPINC+0YLQvtCx0YDQsNC20LXQvdC40Y8g0L7RiNC40LHQvtC6LlxuICAgKiBAcGFyYW0gZXJyb3JGdW5jdGlvbiB7bnVsbHxGdW5jdGlvbn0g0KTRg9C90LrRhtC40Y8g0L7QsdGA0LDQsdC+0YLRh9C40Log0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQvtGI0LjQsdC+0LouXG4gICAqL1xuICBzZXQgZXJyb3JGdW5jdGlvbihlcnJvckZ1bmN0aW9uKSB7XG4gICAgaWYgKGVycm9yRnVuY3Rpb24pIHtcbiAgICAgIHRoaXMuZXJyb3JGdW5jdGlvbiA9IGVycm9yRnVuY3Rpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQtdC90LjQtSDQvNC10YLQvtC00LAg0LTQu9GPINC+0LHRgNCw0LHQvtGC0LrQuCDRg9GB0L/QtdGI0L3QvtCz0L4g0LTQvtCx0LDQstC70LXQvdC40Y8v0YPQtNCw0LvQtdC90LjRjyDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICogQHR5cGUge251bGx8RnVuY3Rpb259INCk0YPQvdC60YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC6INGD0YHQv9C10YjQvdC+0LPQviDQtNC+0LHQsNCy0LvQtdC90LjRjy/Rg9C00LDQu9C10L3QuNGPINGE0L7RgtC+0LPRgNCw0YTQuNC4LlxuICAgKi9cbiAgZ2V0IHN1Y2Nlc3NGdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdWNjZXNzRnVuY3Rpb247XG4gIH1cblxuICAvKipcbiAgICog0J3QsNC30L3QsNGH0LXQvdC40LUg0LzQtdGC0L7QtNCwINC00LvRjyDQvtCx0YDQsNCx0L7RgtC60Lgg0YPRgdC/0LXRiNC90L7Qs9C+INC00L7QsdCw0LLQu9C10L3QuNGPL9GD0LTQsNC70LXQvdC40Y8g0YTQvtGC0L7Qs9GA0LDRhNC40LguXG4gICAqIEBwYXJhbSBzdWNjZXNzRnVuY3Rpb24ge251bGx8RnVuY3Rpb259INCk0YPQvdC60YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0LHRgNCw0LHQvtGC0LrQuCDRg9GB0L/QtdGI0L3QvtCz0L4g0LTQvtCx0LDQstC70LXQvdC40Y8v0YPQtNCw0LvQtdC90LjRjyDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICovXG4gIHNldCBzdWNjZXNzRnVuY3Rpb24oc3VjY2Vzc0Z1bmN0aW9uKSB7XG4gICAgaWYgKHN1Y2Nlc3NGdW5jdGlvbikge1xuICAgICAgdGhpcy5zdWNjZXNzRnVuY3Rpb24gPSBzdWNjZXNzRnVuY3Rpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCe0LHQvdC+0LLQu9C10L3QuNC1INC/0LDRgNCw0LzQtdGC0YDQvtCyINCz0LDQu9C10YDQtdC4LlxuICAgKiBAcGFyYW0gZW1wbG95ZWVJZCB7bnVtYmVyfG51bWJlcn0gSUQg0YHQvtGC0YDRg9C00L3QuNC60LAuXG4gICAqIEBwYXJhbSB0b2tlbiB7c3RyaW5nfSBDU1JGLdGC0L7QutC10L0g0YHQtdGB0YHQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8uXG4gICAqL1xuICB1cGRhdGUoe2VtcGxveWVlSWQsIHRva2VufSkge1xuICAgIHRoaXMuZW1wbG95ZWVJZCA9IGVtcGxveWVlSWQ7XG4gICAgdGhpcy50b2tlbiA9IHRva2VuO1xuXG4gICAgdGhpcy5kcmF3KCk7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C40YLRjCBJRCDRgdC+0YLRgNGD0LTQvdC40LrQsC5cbiAgICogQHJldHVybiB7bnVtYmVyfHN0cmluZ30gSUQg0YHQvtGC0YDRg9C00L3QuNC60LAuXG4gICAqL1xuICBnZXQgZW1wbG95ZWVJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5lbXBsb3llZS5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDQndCw0LfQvdCw0YfQtdC90LjQtSDRjdC60LfQtdC80L/Qu9GP0YDRgyDQs9Cw0LvQtdGA0LXQuCBJRCDRgdC+0YLRgNGD0LTQvdC40LrQsC5cbiAgICogQHBhcmFtIGVtcGxveWVlSWQge251bWJlcnxzdHJpbmd9IElEINGB0L7RgtGA0YPQtNC90LjQutCwLlxuICAgKi9cbiAgc2V0IGVtcGxveWVlSWQoZW1wbG95ZWVJZCkge1xuICAgIGlmIChlbXBsb3llZUlkKSB7XG4gICAgICB0aGlzLmVtcGxveWVlLmlkID0gZW1wbG95ZWVJZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C40YLRjCBJRCDRgdC+0YLRgNGD0LTQvdC40LrQsCDQsNGD0YLRgdC+0YDRgdC10YDQsC5cbiAgICogQHJldHVybiB7bnVtYmVyfHN0cmluZ30gSUQg0YHQvtGC0YDRg9C00L3QuNC60LAg0LDRg9GC0YHQvtGA0YHQtdGA0LAuXG4gICAqL1xuICBnZXQgdmlzaW9uUGVyc29uSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZW1wbG95ZWUudmlzaW9uUGVyc29uSWQ7XG4gIH1cblxuICAvKipcbiAgICog0J3QsNC30L3QsNGH0LXQvdC40LUg0Y3QutC30LXQvNC/0LvRj9GA0YMg0LPQsNC70LXRgNC10LggSUQg0YHQvtGC0YDRg9C00L3QuNC60LAg0LDRg9GC0YHQvtGA0YHQtdGA0LAuXG4gICAqIEBwYXJhbSB2aXNpb25QZXJzb25JZCB7bnVtYmVyfHN0cmluZ30gSUQg0YHQvtGC0YDRg9C00L3QuNC60LAg0LDRg9GC0YHQvtGA0YHQtdGA0LAuXG4gICAqL1xuICBzZXQgdmlzaW9uUGVyc29uSWQodmlzaW9uUGVyc29uSWQpIHtcbiAgICBpZiAodmlzaW9uUGVyc29uSWQpIHtcbiAgICAgIHRoaXMuZW1wbG95ZWUudmlzaW9uUGVyc29uSWQgPSB2aXNpb25QZXJzb25JZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C40YLRjCBJRCDRgdC+0YLRgNGD0LTQvdC40LrQsCDQsNGD0YLRgdC+0YDRgdC10YDQsC5cbiAgICogQHJldHVybiB7bnVtYmVyfHN0cmluZ30gSUQg0YHQvtGC0YDRg9C00L3QuNC60LAg0LDRg9GC0YHQvtGA0YHQtdGA0LAuXG4gICAqL1xuICBnZXQgcGVyc29uSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuZW1wbG95ZWUucGVyc29uSWQ7XG4gIH1cblxuICAvKipcbiAgICog0J3QsNC30L3QsNGH0LXQvdC40LUg0Y3QutC30LXQvNC/0LvRj9GA0YMg0LPQsNC70LXRgNC10LggSUQg0YHQvtGC0YDRg9C00L3QuNC60LAg0LDRg9GC0YHQvtGA0YHQtdGA0LAuXG4gICAqIEBwYXJhbSBwZXJzb25JZCB7bnVtYmVyfHN0cmluZ30gSUQg0YHQvtGC0YDRg9C00L3QuNC60LAg0LDRg9GC0YHQvtGA0YHQtdGA0LAuXG4gICAqL1xuICBzZXQgcGVyc29uSWQocGVyc29uSWQpIHtcbiAgICBpZiAocGVyc29uSWQpIHtcbiAgICAgIHRoaXMuZW1wbG95ZWUucGVyc29uSWQgPSBwZXJzb25JZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog0JrQvtGA0L3QtdCy0L7QuSDRjdC70LXQvNC10L3Rgiwg0LIg0LrQvtGC0L7RgNGL0Lkg0LHRg9C00LXRgiDRgNC10L3QtNC10YDQuNGC0YzRgdGPINCz0LDQu9C10YDQtdGPLlxuICAgKiBAcmV0dXJuIHtudWxsfEVsZW1lbnR9INCa0L7RgNC90LXQstC+0Lkg0Y3Qu9C10LzQtdC90YIg0LTQu9GPINGA0LXQvdC00LXRgNCwLlxuICAgKi9cbiAgZ2V0IHJvb3RFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLnJvb3RFbGVtZW50O1xuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQuNGC0YwgQ1NSRi3RgtC+0LrQtdC9INGB0LXRgdGB0LjQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8uXG4gICAqIEByZXR1cm4ge251bGx8c3RyaW5nfSBDU1JGLdGC0L7QutC10L0g0YHQtdGB0YHQuNC4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjy5cbiAgICovXG4gIGdldCB0b2tlbigpIHtcbiAgICByZXR1cm4gdGhpcy50b2tlbjtcbiAgfVxuXG4gIC8qKlxuICAgKiDQndCw0LfQvdCw0YfQuNGC0YwgQ1NSRi3RgtC+0LrQtdC9INGB0LXRgdGB0LjQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8uXG4gICAqIEBwYXJhbSB0b2tlbiB7c3RyaW5nfSBDU1JGLdGC0L7QutC10L0g0YHQtdGB0YHQuNC4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjy5cbiAgICovXG4gIHNldCB0b2tlbih0b2tlbikge1xuICAgIGlmICh0b2tlbikge1xuICAgICAgdGhpcy50b2tlbiA9IHRva2VuO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LjRgtGMINC30L3QsNGH0LXQvdC40LUg0YHQvtGB0YLQvtGP0L3QuNGPINC60L7QvdGC0YDQvtC70L7Qsi5cbiAgICogQHJldHVybiB7Ym9vbGVhbn0g0KHQvtGB0YLQvtGP0L3QuNC1INC60L7QvdGC0YDQvtC70L7Qsi5cbiAgICovXG4gIGdldCBjb250cm9scygpIHtcbiAgICByZXR1cm4gdGhpcy5jb250cm9scztcbiAgfVxuXG4gIC8qKlxuICAgKiDQndCw0LfQvdCw0YfQuNGC0Ywg0LfQvdCw0YfQtdC90LjQtSDRgdC+0YHRgtC+0Y/QvdC40Y8g0LrQvtC90YLRgNC+0LvQvtCyLlxuICAgKiBAcGFyYW0gdmFsdWUge2Jvb2xlYW59INCS0LrQu9GO0YfQuNGC0Ywv0L7RgtC60LvRjtGH0LjRgtGMINC60L7QvdGC0YDQvtC70YsuXG4gICAqL1xuICBzZXQgY29udHJvbHModmFsdWUpIHtcbiAgICB0aGlzLmNvbnRyb2xzID0ge1xuICAgICAgLi4udGhpcy5jb250cm9scyxcbiAgICAgIC4uLnZhbHVlXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LjRgtGMINGE0LvQsNCzINC30LDQs9GA0YPQt9C60Lgg0YTQvtGC0L7Qs9GA0LDRhNC40Lkg0LjQtyDQvNCw0YHRgtC10YAt0LDQu9GM0LHQvtC80LAuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59INCh0L7RgdGC0L7Rj9C90LjQtSDRhNC70LDQs9CwINC30LDQs9GA0YPQt9C60Lgg0YTQvtGC0L7Qs9GA0LDRhNC40Lkg0LjQtyDQvNCw0YHRgtC10YAt0LDQu9GM0LHQvtC80LAuXG4gICAqL1xuICBnZXQgbWFzdGVyQWxidW0oKSB7XG4gICAgcmV0dXJuIHRoaXMubWFzdGVyQWxidW07XG4gIH1cblxuICAvKipcbiAgICog0J3QsNC30L3QsNGH0LjRgtGMINGE0LvQsNCzINC30LDQs9GA0YPQt9C60Lgg0YTQvtGC0L7Qs9GA0LDRhNC40Lkg0LjQtyDQvNCw0YHRgtC10YAt0LDQu9GM0LHQvtC80LAuXG4gICAqIEBwYXJhbSB2YWx1ZSB7Ym9vbGVhbn0g0JLQutC70Y7Rh9C40YLRjC/QstGL0LrQu9GO0YfQuNGC0Ywg0LfQsNCz0YDRg9C30LrRgyDQuNC3INC80LDRgdGC0LXRgC3QsNC70YzQsdC+0LzQsC5cbiAgICovXG4gIHNldCBtYXN0ZXJBbGJ1bSh2YWx1ZSkge1xuICAgIHRoaXMubWFzdGVyQWxidW0gPSB2YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQvtGI0LjQsdC+0LouXG4gICAqIEBwYXJhbSBwYXJhbXMubWVzc2FnZSB7c3RyaW5nfSDQodC+0L7QsdGJ0LXQvdC40LUg0L7QsSDQvtGI0LjQsdC60LUuXG4gICAqIEBwYXJhbSBwYXJhbXMuYmxvY2tpbmdFcnJvck1lc3NhZ2Uge3N0cmluZ30g0JHQu9C+0LrQuNGA0YPRjtGJ0LXQtSDQv9C+0YLQvtC6INGB0L7QvtCx0YnQtdC90LjQtSDQvtCxINC+0YjQuNCx0LrQtS5cbiAgICovXG4gIGhhbmRsZUVycm9yKHBhcmFtcykge1xuICAgIGNvbnN0IHttZXNzYWdlLCBibG9ja2luZ0Vycm9yTWVzc2FnZX0gPSBwYXJhbXM7XG5cbiAgICBpZiAodGhpcy5lcnJvckZ1bmN0aW9uKSB7XG4gICAgICBsZXQgbWVzc2FnZVN0cmluZyA9IFwiXCI7XG5cbiAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAobWVzc2FnZS5mYXVsdHN0cmluZykge1xuICAgICAgICAgIG1lc3NhZ2VTdHJpbmcgPSBtZXNzYWdlLmZhdWx0c3RyaW5nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIE9iamVjdC5rZXlzKG1lc3NhZ2UpXG4gICAgICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgICAgICAuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICBtZXNzYWdlU3RyaW5nICs9IGAke21lc3NhZ2Vba2V5XX08YnIvPmA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBtZXNzYWdlU3RyaW5nLmxlbmd0aFxuICAgICAgICA/IG1lc3NhZ2VTdHJpbmdcbiAgICAgICAgOiBKU09OLnN0cmluZ2lmeShtZXNzYWdlKTtcblxuICAgICAgdGhpcy5lcnJvckZ1bmN0aW9uKGVycm9yTWVzc2FnZSwgXCLQntGI0LjQsdC60LBcIik7XG4gICAgfSBlbHNlIGlmIChibG9ja2luZ0Vycm9yTWVzc2FnZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGJsb2NraW5nRXJyb3JNZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCe0LHRgNCw0LHQvtGC0YfQuNC6INGD0YHQv9C10YjQvdC+0LPQviDQtNC+0LHQsNCy0LvQtdC90LjRjy/Rg9C00LDQu9C10L3QuNGPINGE0L7RgtC+0LPRgNCw0YTQuNC4LlxuICAgLy8gKiBAcGFyYW0gcGFyYW1zLmFjdGlvbiB7c3RyaW5nfSDQvdCw0LfQstCw0L3QuNC1INGB0L7QsdGL0YLQuNGPXG4gICAqL1xuICBoYW5kbGVTdWNjZXNzKHBhcmFtcykge1xuICAgIGlmKHRoaXMuc3VjY2Vzc0Z1bmN0aW9uKSB7XG4gICAgICB0aGlzLnN1Y2Nlc3NGdW5jdGlvbihwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDQntCx0ZHRgNGC0LrQsCDQtNC70Y8g0LfQsNC/0YDQvtGB0L7QsiDQuiBBUEkuXG4gICAqIEBwYXJhbSByZXF1ZXN0UGF0aCB7c3RyaW5nfSDQndCw0LfQstCw0L3QuNC1INC80LXRgtC+0LTQsCBBUEkuXG4gICAqIEBwYXJhbSByZXF1ZXN0Qm9keSB7b2JqZWN0fSDQn9Cw0YDQsNC80LXRgtGA0Ysg0LfQsNC/0YDQvtGB0LAuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0g0J/RgNC+0LzQuNGBINC30LDQv9GA0L7RgdCwLlxuICAgKi9cbiAgcmVxdWVzdCh7cmVxdWVzdFBhdGgsIHJlcXVlc3RCb2R5fSkge1xuICAgIGNvbnN0IHJlcXVlc3REZWZhdWx0cyA9IHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBtb2RlOiBcInNhbWUtb3JpZ2luXCIsXG4gICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgXCJYLUNTUkZUb2tlblwiOiB0aGlzLnRva2VuXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG4gICAgfTtcblxuICAgIHJldHVybiBmZXRjaChgL2FwaS92Mi92aXNpb24vJHtyZXF1ZXN0UGF0aH0vYCwgcmVxdWVzdERlZmF1bHRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQktGL0LPRgNGD0LfQutCwINCy0YHQtdGFINGE0L7RgtC+0LPRgNCw0YTQuNC5INGBINC/0L7RgNGC0LDQu9CwIFZpc2lvbi5cbiAgICogQHJldHVybnMge1Byb21pc2U8UmVzcG9uc2U+fSDQn9GA0L7QvNC40YEg0YEg0YDQtdC30YPQu9GM0YLQsNGC0L7QvCDQstGL0L/QvtC70L3QtdC90LjRjyDQt9Cw0L/RgNC+0YHQsC5cbiAgICovXG4gIGdldFBob3RvcygpIHtcbiAgICBjb25zdCBlbXBsb3llZSA9IHt9O1xuXG4gICAgaWYgKHRoaXMuZW1wbG95ZWVJZCAmJiAhdGhpcy52aXNpb25QZXJzb25JZCkge1xuICAgICAgZW1wbG95ZWUuZW1wbG95ZWVJZCA9IHRoaXMuZW1wbG95ZWVJZDtcbiAgICB9IGVsc2UgaWYgKHRoaXMudmlzaW9uUGVyc29uSWQpIHtcbiAgICAgIGVtcGxveWVlLnZpc2lvbl9wZXJzb25faWQgPSB0aGlzLnZpc2lvblBlcnNvbklkO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wZXJzb25JZCkge1xuICAgICAgZW1wbG95ZWUucGVyc29uSWQgPSB0aGlzLnBlcnNvbklkO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgcmVxdWVzdFBhdGg6IFwiZ2V0X3Bob3Rvc1wiLFxuICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgLi4uZW1wbG95ZWUsXG4gICAgICAgIG1hc3RlckFsYnVtOiB0aGlzLm1hc3RlckFsYnVtXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog0JfQsNC/0YDQvtGBINC90LAg0LTQvtCx0LDQstC70LXQvdC40LUgKNC30LDQs9GA0YPQt9C60YMpINGE0L7RgtC+0LPRgNCw0YTQuNC4LlxuICAgKiBAcGFyYW0gaW1hZ2Uge0J1ZmZlckVuY29kaW5nfSDQpNC+0YLQvtCz0YDQsNGE0LjQuCDQsiDRhNC+0YDQvNCw0YLQtSBCYXNlNjQuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0g0J/RgNC+0LzQuNGBINGBINGA0LXQt9GD0LvRjNGC0LDRgtC+0Lwg0LLRi9C/0L7Qu9C90LXQvdC40Y8g0LfQsNC/0YDQvtGB0LAuXG4gICAqL1xuICBhZGRQaG90byhpbWFnZSkge1xuICAgIHRoaXMudG9nZ2xlT3ZlcmxheU1lc3NhZ2UoJ9CX0LDQs9GA0YPQt9C60LAuLi4nKTtcblxuICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgcmVxdWVzdFBhdGg6IFwiYWRkX3Bob3RvXCIsXG4gICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICBlbXBsb3llZUlkOiB0aGlzLmVtcGxveWVlSWQsXG4gICAgICAgIGltYWdlXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog0JfQsNC/0YDQvtGBINC90LAg0YPQtNCw0LvQtdC90LjQtSDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICogQHBhcmFtIHBob3RvSWQge051bWJlcn0gSUQg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0L3QsCDQv9C+0YDRgtCw0LvQtSBWaXNpb24uXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0g0J/RgNC+0LzQuNGBINGBINGA0LXQt9GD0LvRjNGC0LDRgtC+0Lwg0LLRi9C/0L7Qu9C90LXQvdC40Y8g0LfQsNC/0YDQvtGB0LAuXG4gICAqL1xuICBkZWxldGVQaG90byhwaG90b0lkKSB7XG4gICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgn0KPQtNCw0LvQtdC90LjQtSDRhNC+0YLQvtCz0YDQsNGE0LjQuC4uLicpO1xuXG4gICAgY29uc3QgZW1wbG95ZWVJZCA9IHRoaXMuZW1wbG95ZWVJZDtcblxuICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgcmVxdWVzdFBhdGg6IFwiZGVsZXRlX3Bob3RvXCIsXG4gICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICBlbXBsb3llZV9pZDogZW1wbG95ZWVJZCxcbiAgICAgICAgcGhvdG9faWQ6IHBob3RvSWRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQl9Cw0L/RgNC+0YEg0L3QsCDQvtCx0L3QvtCy0LvQtdC90LjQtSDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICogQHBhcmFtIHBob3RvSWQge051bWJlcn0gSUQg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0L3QsCDQv9C+0YDRgtCw0LvQtSBWaXNpb24uXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0g0J/RgNC+0LzQuNGBINGBINGA0LXQt9GD0LvRjNGC0LDRgtC+0Lwg0LLRi9C/0L7Qu9C90LXQvdC40Y8g0LfQsNC/0YDQvtGB0LAuXG4gICAqL1xuICB1cGRhdGVQaG90byhwaG90b0lkKSB7XG4gICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgn0J7QsdC90L7QstC70LXQvdC40LUg0YTQvtGC0L7Qs9GA0LDRhNC40LguLi4nKTtcblxuICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgcmVxdWVzdFBhdGg6IFwidXBkYXRlX3Bob3RvXCIsXG4gICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICBlbXBsb3llZUlkOiB0aGlzLmVtcGxveWVlSWQsXG4gICAgICAgIHBob3RvX2lkOiBwaG90b0lkXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog0JfQsNC/0YDQvtGBINC90LAg0YPRgdGC0LDQvdC+0LLQutGDINGE0L7RgtC+0LPRgNCw0YTQuNC4INC60LDQuiDQvtGB0L3QvtCy0L3QvtC5INC00LvRjyDRgdC+0YLRgNGD0LTQvdC40LrQsC5cbiAgICogQHBhcmFtIHBob3RvSWQge051bWJlcn0gSUQg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0L3QsCDQv9C+0YDRgtCw0LvQtSBWaXNpb24uXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0g0J/RgNC+0LzQuNGBINGBINGA0LXQt9GD0LvRjNGC0LDRgtC+0Lwg0LLRi9C/0L7Qu9C90LXQvdC40Y8g0LfQsNC/0YDQvtGB0LAuXG4gICAqL1xuICBzZXRBc01haW5QaG90byhwaG90b0lkKSB7XG4gICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgn0J7QsdC90L7QstC70LXQvdC40LUg0L7RgdC90L7QstC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuC4uLicpO1xuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh7XG4gICAgICByZXF1ZXN0UGF0aDogXCJzZXRfbWFpbl9waG90b1wiLFxuICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgZW1wbG95ZWVJZDogdGhpcy5lbXBsb3llZUlkLFxuICAgICAgICBwaG90b0lkOiBwaG90b0lkXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog0J/QtdGA0LXQutC70Y7Rh9Cw0YLQtdC70Ywg0LHQu9C+0LrQuNGA0YPRjtGJ0LXQs9C+INGB0L7QvtCx0YnQtdC90LjRjy5cbiAgICogQHBhcmFtIG1lc3NhZ2Uge3N0cmluZ3x1bmRlZmluZWR8bnVsbH0g0KHQvtC+0LHRidC10L3QuNC1LlxuICAgKi9cbiAgdG9nZ2xlT3ZlcmxheU1lc3NhZ2UobWVzc2FnZSA9IG51bGwpIHtcbiAgICBjb25zdCB7Z2FsbGVyeUNvbnRhaW5lcn0gPSB0aGlzO1xuXG4gICAgaWYgKCFnYWxsZXJ5Q29udGFpbmVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ9Cd0LUg0L3QsNC50LTQtdC90LAg0LrQvtGA0L3QtdCy0L7QuSDRjdC70LXQvNC10L3RgiDQs9Cw0LvQtdGA0LXQuCcpO1xuICAgIH1cblxuICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICBnYWxsZXJ5Q29udGFpbmVyLmRhdGFzZXQubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICBnYWxsZXJ5Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3Zpc2lvbi1waG90by1nYWxsZXJ5LS1tZXNzYWdlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGdhbGxlcnlDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgndmlzaW9uLXBob3RvLWdhbGxlcnktLW1lc3NhZ2UnKTtcbiAgICAgIGdhbGxlcnlDb250YWluZXIuZGF0YXNldC5tZXNzYWdlID0gJyc7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCe0YLRgNC40YHQvtCy0LrQsCBET00g0LPQsNC70LXRgNC10LjQuC5cbiAgICovXG4gIGRyYXcocGFyYW1zID0ge30pIHtcbiAgICBjb25zdCByb290RWxlbWVudCA9IHRoaXMucm9vdEVsZW1lbnQ7XG5cbiAgICByb290RWxlbWVudC5pbm5lckhUTUwgPSBgXG4gICAgICA8ZGl2IGNsYXNzPVwidmlzaW9uLXBob3RvLWdhbGxlcnlcIj5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJmaWxlXCIgY2xhc3M9XCJ2aXNpb24tcGhvdG8tZ2FsbGVyeV9fZmlsZS1maWVsZFwiIHRhYmluZGV4PVwiLTFcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInZpc2lvbi1waG90by1nYWxsZXJ5X19pdGVtIHZpc2lvbi1waG90by1nYWxsZXJ5X19pdGVtLS1tYWluXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInZnLW1haW4tcGhvdG9cIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ2aXNpb24tcGhvdG8tZ2FsbGVyeV9faXRlbVwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2Zy1nYWxsZXJ5XCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYDtcblxuICAgIGNvbnN0IGdhbGxlcnlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZpc2lvbi1waG90by1nYWxsZXJ5XCIpO1xuXG4gICAgdGhpcy5nYWxsZXJ5Q29udGFpbmVyID0gZ2FsbGVyeUNvbnRhaW5lcjtcbiAgICB0aGlzLnRvZ2dsZU92ZXJsYXlNZXNzYWdlKCfQl9Cw0LPRgNGD0LfQutCwLi4uJyk7XG5cbiAgICBjb25zdCBtYWluUGhvdG9Db250YWluZXIgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnZnLW1haW4tcGhvdG9cIik7XG4gICAgY29uc3QgZ2FsbGVyeSA9IHJvb3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudmctZ2FsbGVyeVwiKTtcbiAgICBjb25zdCB7dXBsb2FkfSA9IHRoaXMuY29udHJvbHM7XG5cbiAgICB0aGlzLmdldFBob3RvcygpXG4gICAgICAudGhlbihcbiAgICAgICAgcmVzcG9uc2UgPT4ge1xuICAgICAgICAgIG1haW5QaG90b0NvbnRhaW5lci5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZVBob3RvRWxlbWVudCh7XG4gICAgICAgICAgICBtYWluOiB0cnVlLFxuICAgICAgICAgICAgZW1wdHk6IHRydWUsXG4gICAgICAgICAgICBwaG90b0lkOiBudWxsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAodXBsb2FkKSB7XG4gICAgICAgICAgICBnYWxsZXJ5LmlubmVySFRNTCA9IHRoaXMuY3JlYXRlUGhvdG9FbGVtZW50KHtcbiAgICAgICAgICAgICAgbWFpbjogZmFsc2UsXG4gICAgICAgICAgICAgIGVtcHR5OiB0cnVlLFxuICAgICAgICAgICAgICBwaG90b0lkOiBudWxsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1haW5QaG90b0NvbnRhaW5lci5pbm5lckhUTUwgPSB0aGlzLmNyZWF0ZU5vUGhvdG9FbGVtZW50KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgpO1xuICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLmluaXRFdmVudHMoKTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgICAgLnRoZW4oXG4gICAgICAgIHJlc3BvbnNlSnNvbiA9PiB7XG4gICAgICAgICAgY29uc3Qgc3VjY2Vzc1BhcmFtcyA9IHtcbiAgICAgICAgICAgIGFjdGlvbjogcGFyYW1zLmFjdGlvbixcbiAgICAgICAgICAgIHBob3RvczogcmVzcG9uc2VKc29uLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAoIXJlc3BvbnNlSnNvbiB8fCAhcmVzcG9uc2VKc29uLmxlbmd0aCkge1xuICAgICAgICAgICAgbWFpblBob3RvQ29udGFpbmVyLmlubmVySFRNTCA9IHRoaXMuY3JlYXRlTm9QaG90b0VsZW1lbnQoKTtcbiAgICAgICAgICAgIGdhbGxlcnkucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgpO1xuXG4gICAgICAgICAgICBpZiAocGFyYW1zLmFjdGlvbiA9PT0gJ3Bob3RvUmVtb3ZlTWFpbicpIHtcbiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTdWNjZXNzKHN1Y2Nlc3NQYXJhbXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgbWFpblBob3RvRGF0YSA9IHJlc3BvbnNlSnNvbi5maW5kKCh7bWFpbn0pID0+IG1haW4pO1xuICAgICAgICAgIGNvbnN0IGdhbGxlcnlQaG90b3NEYXRhID0gcmVzcG9uc2VKc29uLmZpbHRlcigoe21haW59KSA9PiAhbWFpbik7XG5cbiAgICAgICAgICBpZiAoISFtYWluUGhvdG9EYXRhKSB7XG4gICAgICAgICAgICBtYWluUGhvdG9Db250YWluZXIuaW5uZXJIVE1MID0gdGhpcy5jcmVhdGVQaG90b0VsZW1lbnQoXG4gICAgICAgICAgICAgIG1haW5QaG90b0RhdGFcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1haW5QaG90b0NvbnRhaW5lci5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGdhbGxlcnlQaG90b3NEYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IGdhbGxlcnlQaG90b3NIdG1sID0gXCJcIjtcblxuICAgICAgICAgICAgZ2FsbGVyeVBob3Rvc0RhdGEuZm9yRWFjaChcbiAgICAgICAgICAgICAgcGhvdG9EYXRhID0+XG4gICAgICAgICAgICAgICAgKGdhbGxlcnlQaG90b3NIdG1sICs9IHRoaXMuY3JlYXRlUGhvdG9FbGVtZW50KHBob3RvRGF0YSkpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAodXBsb2FkKSB7XG4gICAgICAgICAgICAgIGdhbGxlcnlQaG90b3NIdG1sICs9IHRoaXMuY3JlYXRlUGhvdG9FbGVtZW50KHtcbiAgICAgICAgICAgICAgICBtYWluOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlbXB0eTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwaG90b0lkOiBudWxsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnYWxsZXJ5LmlubmVySFRNTCA9IGdhbGxlcnlQaG90b3NIdG1sO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIXVwbG9hZCkge1xuICAgICAgICAgICAgZ2FsbGVyeS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gICAgICAgICAgdGhpcy50b2dnbGVPdmVybGF5TWVzc2FnZSgpO1xuICAgICAgICAgIHRoaXMuaGFuZGxlU3VjY2VzcyhzdWNjZXNzUGFyYW1zKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aGlzLnRvZ2dsZU92ZXJsYXlNZXNzYWdlKCk7XG4gICAgICAgICAgdGhpcy5pbml0RXZlbnRzKCk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIHRoaXMudG9nZ2xlT3ZlcmxheU1lc3NhZ2UoKTtcbiAgICAgICAgdGhpcy5oYW5kbGVFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3JcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW5pdEV2ZW50cygpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLmluaXRFdmVudHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDQvNC10YLQvtC0INC00LvRjyDRgdC+0LfQtNCw0L3QuNGPINGN0LvQtdC80LXQvdGC0LAg0YTQvtGC0L7Qs9GA0LDRhNC40LguXG4gICAqIEBwYXJhbSBwYXJhbXMucGhvdG9JZCB7bnVtYmVyfSBJRCDRhNC+0YLQvtCz0YDQsNGE0LjQuCDQvdCwINC/0L7RgNGC0LDQu9C1IFZpc2lvbi5cbiAgICogQHBhcmFtIHBhcmFtcy5tYWluIHtib29sZWFufSAg0KTQu9Cw0LMg0L7RgdC90L7QstC90L7Qs9C+INGE0L7RgtC+LlxuICAgKiBAcGFyYW0gcGFyYW1zLmVtcHR5IHtib29sZWFufSDQpNC70LDQsyBcItC/0YPRgdGC0L7Qs9C+XCIg0YTQvtGC0L4sINC40YHQv9C+0LvRjNC30YPQtdGC0YHRjyDQtNC70Y8g0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQutC90L7Qv9C60Lgg0LfQsNCz0YDRg9C30LrQuC5cbiAgICogQHBhcmFtIHBhcmFtcy5wYXRoIHtzdHJpbmd9INCf0YPRgtGMINC6INGE0L7RgtC+0LPRgNCw0YTQuNC4LlxuICAgKiBAcGFyYW0gcGFyYW1zLmF2YXRhclVybCB7c3RyaW5nfSDQn9GD0YLRjCDQuiDRhNC+0YLQvtCz0YDQsNGE0LjQuC5cbiAgICogQHJldHVybnMge3N0cmluZ30g0K3Qu9C10LzQtdC90YIg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0LIg0LLQuNC00LUg0YHRgtGA0L7QutC4LlxuICAgKi9cbiAgY3JlYXRlUGhvdG9FbGVtZW50KHBhcmFtcykge1xuICAgIGNvbnN0IHtwaG90b0lkLCBtYWluLCBlbXB0eSwgcGF0aCwgYXZhdGFyVXJsfSA9IHBhcmFtcztcbiAgICBjb25zdCB7ZGlzYWJsZUFsbCwgdXBsb2FkLCB1cGRhdGUsIHJlbW92ZSA9ICFlbXB0eX0gPSB0aGlzLmNvbnRyb2xzO1xuICAgIGxldCBidXR0b25zID0gXCJcIjtcbiAgICBsZXQgZWxlbWVudENsYXNzZXMgPSBcIlwiO1xuICAgIGxldCBiYWNrZ3JvdW5kSW1hZ2UgPSBcIlwiO1xuICAgIGxldCBtYWluQXR0cmlidXRlID0gXCJcIjtcblxuICAgIGlmICghYXZhdGFyVXJsICYmIHBhdGgpIHtcbiAgICAgIGJhY2tncm91bmRJbWFnZSA9IGBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6IHVybCgke3BhdGh9KVwiYDtcbiAgICB9XG5cbiAgICBpZiAoYXZhdGFyVXJsKSB7XG4gICAgICBiYWNrZ3JvdW5kSW1hZ2UgPSBgc3R5bGU9XCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHthdmF0YXJVcmx9KVwiYDtcbiAgICB9XG5cbiAgICBpZiAobWFpbikge1xuICAgICAgbWFpbkF0dHJpYnV0ZSA9IGBkYXRhLW1haW49XCIke21haW59XCJgO1xuXG4gICAgICBpZiAoZW1wdHkpIHtcbiAgICAgICAgZWxlbWVudENsYXNzZXMgPSBcInZnLXBob3RvIHZnLXBob3RvLS1tYWluXCI7XG4gICAgICAgIGJ1dHRvbnMgPSB0aGlzLmdldFBob3RvQnV0dG9ucyh7XG4gICAgICAgICAgdXBsb2FkXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudENsYXNzZXMgPSBcInZnLXBob3RvIHZnLXBob3RvLS1tYWluXCI7XG4gICAgICAgIGJ1dHRvbnMgPSB0aGlzLmdldFBob3RvQnV0dG9ucyh7XG4gICAgICAgICAgcmVtb3ZlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZW1wdHkpIHtcbiAgICAgICAgZWxlbWVudENsYXNzZXMgPSBcInZnLWdhbGxlcnlfX2l0ZW0gdmctcGhvdG8gdmctcGhvdG8tLXVwbG9hZFwiO1xuICAgICAgICBidXR0b25zID0gdGhpcy5nZXRQaG90b0J1dHRvbnMoe1xuICAgICAgICAgIHVwbG9hZEljb246IHVwbG9hZFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnRDbGFzc2VzID0gXCJ2Zy1nYWxsZXJ5X19pdGVtIHZnLXBob3RvXCI7XG4gICAgICAgIGJ1dHRvbnMgPSB0aGlzLmdldFBob3RvQnV0dG9ucyh7XG4gICAgICAgICAgdXBkYXRlLFxuICAgICAgICAgIHJlbW92ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYFxuICAgICAgPGRpdiBjbGFzcz1cIiR7ZWxlbWVudENsYXNzZXN9XCJcbiAgICAgICAgJHtiYWNrZ3JvdW5kSW1hZ2V9XG4gICAgICAgIGRhdGEtcGhvdG8taWQ9XCIke3Bob3RvSWR9XCJcbiAgICAgICAgJHttYWluQXR0cmlidXRlfT5cbiAgICAgICAgJHtkaXNhYmxlQWxsID8gXCJcIiA6IGJ1dHRvbnN9XG4gICAgICAgIDwvZGl2PlxuICAgICAgYDtcbiAgfVxuXG4gIC8qKlxuICAgKiDQqNCw0LHQu9C+0L0g0Y3Qu9C10LzQtdC90YLQsCDQs9Cw0LvQtdGA0LXQuCDQsdC10Lcg0YTQvtGC0L7Qs9GA0LDRhNC40LhcbiAgICogQHJldHVybiB7c3RyaW5nfSBIVE1MIERPTSBTdHJpbmdcbiAgICovXG4gIGNyZWF0ZU5vUGhvdG9FbGVtZW50KCkge1xuICAgIHJldHVybiBgXG4gICAgICA8ZGl2IGNsYXNzPVwidmctcGhvdG8gdmctcGhvdG8tLW1haW5cIj5cbiAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIi0yNTYgLTI1NiAxMDI0IDEwMjRcIj5cbiAgICAgICAgICA8cGF0aCBmaWxsPVwiIzRhNTI2NlwiXG4gICAgICAgICAgICBkPVwiTTQzNyAzMTAuOGMtMjguNC0yOC40LTYyLjItNDkuMi05OS4xLTYxLjcgMzQuMS0yNS4yIDU2LjItNjUuNiA1Ni4yLTExMS4xQzM5NC4xIDYxLjkgMzMyLjEgMCAyNTYgMFMxMTcuOSA2MS45IDExNy45IDEzOC4xYzAgNDUuNSAyMi4xIDg1LjkgNTYuMiAxMTEuMSAtMzYuOSAxMi40LTcwLjggMzMuMy05OS4xIDYxLjdDMjYuNiAzNTkuMiAwIDQyMy41IDAgNDkxLjggMCA1MDMgOSA1MTIgMjAuMiA1MTJoNDcxLjdjMTEuMSAwIDIwLjItOSAyMC4yLTIwLjJDNTEyIDQyMy41IDQ4NS40IDM1OS4yIDQzNyAzMTAuOHpNMTU4LjIgMTM4LjFjMC01My45IDQzLjktOTcuOCA5Ny44LTk3LjggNTMuOSAwIDk3LjggNDMuOSA5Ny44IDk3LjggMCA1My45LTQzLjkgOTcuOC05Ny44IDk3LjhDMjAyLjEgMjM1LjggMTU4LjIgMTkyIDE1OC4yIDEzOC4xek00MS4yIDQ3MS43QzUxLjQgMzYyLjIgMTQzLjkgMjc2LjIgMjU2IDI3Ni4yczIwNC42IDg2IDIxNC44IDE5NS41SDQxLjJ6XCIvPlxuICAgICAgICA8L3N2Zz5cbiAgICAgIDwvZGl2PlxuICAgIGA7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C40YLRjCDQutC90L7Qv9C60YMg0L/QviDQv9C10YDQtdC00LDQstCw0LXQvNGL0Lwg0L/QsNGA0LDQvNC10YLRgNCw0LwuXG4gICAqIEBwYXJhbSBwYXJhbXMuZGlzYWJsZUFsbCB7Ym9vbGVhbn0g0J7RgtC60LvRjtGH0LjRgtGMINCy0YHQtSDQutC90L7Qv9C60LguXG4gICAqIEBwYXJhbSBwYXJhbXMucmVtb3ZlIHtib29sZWFufSDQmtC90L7Qv9C60LAg0YPQtNCw0LvQtdC90LjRjy5cbiAgICogQHBhcmFtIHBhcmFtcy51cGxvYWQge2Jvb2xlYW59INCa0L3QvtC/0LrQsCDQt9Cw0LPRgNGD0LfQutC4LlxuICAgKiBAcGFyYW0gcGFyYW1zLnVwbG9hZEljb24ge2Jvb2xlYW59INCa0L3QvtC/0LrQsCDQt9Cw0LPRgNGD0LfQutC4INCyINCy0LjQtNC1INC40LrQvtC90LrQuC5cbiAgICogQHBhcmFtIHBhcmFtcy5zZWxlY3Qge2Jvb2xlYW59INCa0L3QvtC/0LrQsCDQstGL0LHQvtGA0LAg0YTQvtGC0L7Qs9GA0LDRhNC40LguXG4gICAqL1xuICBnZXRQaG90b0J1dHRvbnMocGFyYW1zKSB7XG4gICAgaWYgKHBhcmFtcy5kaXNhYmxlQWxsKSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG5cbiAgICBjb25zdCBidXR0b25zID0ge1xuICAgICAgcmVtb3ZlOiBgPGJ1dHRvbiBjbGFzcz1cInZnLXBob3RvX19idXR0b24gdmctYnV0dG9uIHZnLWJ1dHRvbi0tcmVkXCIgZGF0YS1hY3Rpb249XCJyZW1vdmUtcGhvdG9cIj7Qo9C00LDQu9C40YLRjDwvYnV0dG9uPmAsXG4gICAgICB1cGxvYWQ6IGA8YnV0dG9uIGNsYXNzPVwidmctcGhvdG9fX2J1dHRvbiB2Zy1idXR0b25cIiBkYXRhLWFjdGlvbj1cInVwbG9hZC1waG90b1wiPtCX0LDQs9GA0YPQt9C40YLRjDwvYnV0dG9uPmAsXG4gICAgICB1cGxvYWRJY29uOiBgPGJ1dHRvbiBjbGFzcz1cInZnLXBob3RvX19idXR0b24gdmctYnV0dG9uIHZnLWJ1dHRvbi0tdXBsb2FkXCIgZGF0YS1hY3Rpb249XCJ1cGxvYWQtcGhvdG9cIj4mIzQzOzwvYnV0dG9uPmAsXG4gICAgICB1cGRhdGU6IGA8YnV0dG9uIGNsYXNzPVwidmctcGhvdG9fX2J1dHRvbiB2Zy1idXR0b24gdmctYnV0dG9uLS1ncmVlblwiIGRhdGEtYWN0aW9uPVwidXBkYXRlLXBob3RvXCI+0JLRi9Cx0YDQsNGC0Yw8L2J1dHRvbj5gXG4gICAgfTtcblxuICAgIHJldHVybiBPYmplY3Qua2V5cyhwYXJhbXMpLnJlZHVjZSgoYnV0dG9uc1N0cmluZywga2V5KSA9PiB7XG4gICAgICBpZiAocGFyYW1zW2tleV0pIHtcbiAgICAgICAgYnV0dG9uc1N0cmluZyArPSBidXR0b25zW2tleV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBidXR0b25zU3RyaW5nO1xuICAgIH0sIFwiXCIpO1xuICB9XG5cbiAgLyoqXG4gICAqINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINGB0L7QsdGL0YLQuNC5INC00LvRjyDQutC90L7Qv9C+0Log0LPQsNC70LXRgNC10LguXG4gICAqL1xuICBpbml0RXZlbnRzKCkge1xuICAgIGNvbnN0IHtyb290RWxlbWVudH0gPSB0aGlzO1xuICAgIGNvbnN0IGJ1dHRvbnMgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiYnV0dG9uXCIpO1xuXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICB0aGlzLnJvdXRlcltidXR0b24uZGF0YXNldC5hY3Rpb25dLFxuICAgICAgICBmYWxzZVxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQoNC+0YPRgtC10YAuXG4gICAqIEB0eXBlIHt7XCJyZW1vdmUtcGhvdG9cIjogZnVuY3Rpb24oKik6IHZvaWQsIFwiZmlsZS1pbnB1dC1jaGFuZ2VkXCI6IGZ1bmN0aW9uKCopOiB2b2lkLCBcInVwbG9hZC1waG90b1wiOiBmdW5jdGlvbigqKTogdm9pZCwgXCJ1cGRhdGUtcGhvdG9cIjogZnVuY3Rpb24oKik6IHZvaWR9fVxuICAgKi9cbiAgcm91dGVyID0ge1xuICAgIC8qKlxuICAgICAqINCX0LDQs9GA0YPQt9C60LAg0YTQvtGC0L7Qs9GA0LDRhNC40Lgg0YHQvtGC0YDRg9C00L3QuNC60LAuXG4gICAgICogQHBhcmFtIGV2ZW50IHtFdmVudH0g0KHQvtCx0YvRgtC40LUuXG4gICAgICovXG4gICAgXCJ1cGxvYWQtcGhvdG9cIjogZXZlbnQgPT4ge1xuICAgICAgY29uc3QgZmlsZUlucHV0ID0gdGhpcy5yb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPVwiZmlsZVwiXScpO1xuXG4gICAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCB0aGlzLnJvdXRlcltcImZpbGUtaW5wdXQtY2hhbmdlZFwiXSk7XG4gICAgICBmaWxlSW5wdXQuY2xpY2soKTtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqINCh0LvRg9GI0LDRgtC10LvRjCDRgdC+0LHRi9GC0LjRjyDQuNC30LzQtdC90LXQvdC40Y8g0YTQsNC50LvQvtCy0L7Qs9C+INC/0L7Qu9GPINCy0LLQvtC00LAuXG4gICAgICogQHBhcmFtIGV2ZW50IHtldmVudH0g0KHQvtCx0YvRgtC40LUuXG4gICAgICovXG4gICAgXCJmaWxlLWlucHV0LWNoYW5nZWRcIjogZXZlbnQgPT4ge1xuICAgICAgY29uc3QgZmlsZSA9IGV2ZW50LnRhcmdldC5maWxlc1swXTtcbiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xuXG4gICAgICByZWFkZXIub25sb2FkID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmFkZFBob3RvKHJlYWRlci5yZXN1bHQpLnRoZW4oXG4gICAgICAgICAgcmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgaWYocmVzcG9uc2UuZmF1bHRjb2RlKSB7XG4gICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICB0aGlzLmRyYXcoe2FjdGlvbjogJ3VwbG9hZFBob3RvJ30pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcih7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZWFkZXIub25lcnJvciA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5oYW5kbGVFcnJvcih7XG4gICAgICAgICAgbWVzc2FnZTogcmVhZGVyLmVycm9yLFxuICAgICAgICAgIGJsb2NraW5nRXJyb3JNZXNzYWdlOiBg0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0YTQvtGC0L7Qs9GA0LDRhNC40LggKC3QuNC5KTogJHtyZWFkZXIuZXJyb3J9YFxuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiDQl9Cw0L/RgNC+0YEg0L3QsCDRg9C00LDQu9C10L3QuNC1INGE0L7RgtC+0LPRgNCw0YTQuNC4INGB0L7RgtGA0YPQtNC90LjQutCwLlxuICAgICAqIEBwYXJhbSBldmVudCB7RXZlbnR9INCh0L7QsdGL0YLQuNC1LlxuICAgICAqL1xuICAgIFwicmVtb3ZlLXBob3RvXCI6IGV2ZW50ID0+IHtcbiAgICAgIGNvbnN0IHBob3RvRWxlbWVudCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KFwiLnZnLXBob3RvXCIpO1xuICAgICAgY29uc3Qge3Bob3RvSWR9ID0gcGhvdG9FbGVtZW50LmRhdGFzZXQ7XG4gICAgICBjb25zdCBpc01haW5QaG90byA9IHBob3RvRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3ZnLXBob3RvLS1tYWluJyk7XG5cbiAgICAgIGlmICghIXBob3RvSWQpIHtcbiAgICAgICAgdGhpcy5kZWxldGVQaG90bygrcGhvdG9JZCkudGhlbihcbiAgICAgICAgICByZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuZmF1bHRjb2RlKSB7XG4gICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgdGhpcy5kcmF3KHthY3Rpb246IGlzTWFpblBob3RvID8gJ3Bob3RvUmVtb3ZlTWFpbicgOiAncGhvdG9SZW1vdmUnfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqINCX0LDQv9GA0L7RgSDQvdCwINC+0LHQvdC+0LLQu9C10L3QuNC1INGE0L7RgtC+0LPRgNCw0YTQuNC4INGB0L7RgtGA0YPQtNC90LjQutCwLlxuICAgICAqIEBwYXJhbSBldmVudCB7RXZlbnR9INCh0L7QsdGL0YLQuNC1LlxuICAgICAqL1xuICAgIFwidXBkYXRlLXBob3RvXCI6IGV2ZW50ID0+IHtcbiAgICAgIGNvbnN0IHBob3RvRWxlbWVudCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KFwiLnZnLXBob3RvXCIpO1xuICAgICAgY29uc3Qge3Bob3RvSWR9ID0gcGhvdG9FbGVtZW50LmRhdGFzZXQ7XG4gICAgICBjb25zdCBidXR0b25zID0gcGhvdG9FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpO1xuXG4gICAgICBpZiAoISFwaG90b0lkKSB7XG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKSk7XG5cbiAgICAgICAgdGhpcy5zZXRBc01haW5QaG90bygrcGhvdG9JZCkudGhlbihcbiAgICAgICAgICByZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgdGhpcy5kcmF3KHthY3Rpb246ICdwaG90b0FsYnVtJ30pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcih7XG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInRoaXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZ2xvYmFsIiwiZ2xvYmFsVGhpcyIsInNlbGYiLCJzdXBwb3J0IiwiU3ltYm9sIiwiQmxvYiIsImUiLCJ2aWV3Q2xhc3NlcyIsImlzQXJyYXlCdWZmZXJWaWV3IiwiQXJyYXlCdWZmZXIiLCJpc1ZpZXciLCJpbmRleE9mIiwidG9TdHJpbmciLCJub3JtYWxpemVOYW1lIiwibmFtZSIsIlN0cmluZyIsInRlc3QiLCJUeXBlRXJyb3IiLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVZhbHVlIiwidmFsdWUiLCJpdGVyYXRvckZvciIsIml0ZW1zIiwiaXRlcmF0b3IiLCJuZXh0Iiwic2hpZnQiLCJkb25lIiwidW5kZWZpbmVkIiwiSGVhZGVycyIsImhlYWRlcnMiLCJtYXAiLCJmb3JFYWNoIiwiYXBwZW5kIiwiQXJyYXkiLCJpc0FycmF5IiwiaGVhZGVyIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsImNvbnN1bWVkIiwiYm9keSIsImJvZHlVc2VkIiwiUHJvbWlzZSIsInJlamVjdCIsImZpbGVSZWFkZXJSZWFkeSIsInJlYWRlciIsInJlc29sdmUiLCJvbmxvYWQiLCJyZXN1bHQiLCJvbmVycm9yIiwiZXJyb3IiLCJyZWFkQmxvYkFzQXJyYXlCdWZmZXIiLCJibG9iIiwiRmlsZVJlYWRlciIsInByb21pc2UiLCJyZWFkQXNBcnJheUJ1ZmZlciIsImJ1ZmZlckNsb25lIiwiYnVmIiwic2xpY2UiLCJ2aWV3IiwiVWludDhBcnJheSIsImJ5dGVMZW5ndGgiLCJzZXQiLCJidWZmZXIiLCJCb2R5IiwiX2luaXRCb2R5IiwiX2JvZHlJbml0IiwiX2JvZHlUZXh0IiwiaXNQcm90b3R5cGVPZiIsIl9ib2R5QmxvYiIsIkZvcm1EYXRhIiwiX2JvZHlGb3JtRGF0YSIsIlVSTFNlYXJjaFBhcmFtcyIsIkRhdGFWaWV3IiwiX2JvZHlBcnJheUJ1ZmZlciIsInR5cGUiLCJyZWplY3RlZCIsIkVycm9yIiwiYXJyYXlCdWZmZXIiLCJieXRlT2Zmc2V0IiwidGhlbiIsInRleHQiLCJyZWFkQXNUZXh0IiwiY2hhcnMiLCJsZW5ndGgiLCJpIiwiZnJvbUNoYXJDb2RlIiwiam9pbiIsInJlYWRBcnJheUJ1ZmZlckFzVGV4dCIsImZvcm1EYXRhIiwiZGVjb2RlIiwianNvbiIsIkpTT04iLCJwYXJzZSIsIm9sZFZhbHVlIiwiaGFzIiwiY2FsbGJhY2siLCJ0aGlzQXJnIiwia2V5cyIsInB1c2giLCJ2YWx1ZXMiLCJlbnRyaWVzIiwibWV0aG9kcyIsIlJlcXVlc3QiLCJpbnB1dCIsIm9wdGlvbnMiLCJtZXRob2QiLCJ1cGNhc2VkIiwidXJsIiwiY3JlZGVudGlhbHMiLCJtb2RlIiwic2lnbmFsIiwidG9VcHBlckNhc2UiLCJyZWZlcnJlciIsImNhY2hlIiwicmVQYXJhbVNlYXJjaCIsInJlcGxhY2UiLCJEYXRlIiwiZ2V0VGltZSIsImZvcm0iLCJ0cmltIiwic3BsaXQiLCJieXRlcyIsImRlY29kZVVSSUNvbXBvbmVudCIsIlJlc3BvbnNlIiwiYm9keUluaXQiLCJzdGF0dXMiLCJvayIsInN0YXR1c1RleHQiLCJjbG9uZSIsInJlc3BvbnNlIiwicmVkaXJlY3RTdGF0dXNlcyIsInJlZGlyZWN0IiwiUmFuZ2VFcnJvciIsImxvY2F0aW9uIiwiRE9NRXhjZXB0aW9uIiwiZXJyIiwibWVzc2FnZSIsInN0YWNrIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJpbml0IiwicmVxdWVzdCIsImFib3J0ZWQiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsImFib3J0WGhyIiwiYWJvcnQiLCJyYXdIZWFkZXJzIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwic3Vic3RyIiwibGluZSIsInBhcnRzIiwicmVzcG9uc2VVUkwiLCJyZXNwb25zZVRleHQiLCJzZXRUaW1lb3V0Iiwib250aW1lb3V0Iiwib25hYm9ydCIsIm9wZW4iLCJocmVmIiwiZml4VXJsIiwid2l0aENyZWRlbnRpYWxzIiwicmVzcG9uc2VUeXBlIiwic2V0UmVxdWVzdEhlYWRlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNlbmQiLCJwb2x5ZmlsbCIsImZldGNoIiwiVmlzaW9uUGhvdG9HYWxsZXJ5IiwiZW1wbG95ZWVJZCIsInZpc2lvblBlcnNvbklkIiwicGVyc29uSWQiLCJ0b2tlbiIsImNvbnRyb2xzIiwibWFzdGVyQWxidW0iLCJkaXNhYmxlQWxsIiwidXBkYXRlIiwidXBsb2FkIiwicmVtb3ZlIiwiZXZlbnQiLCJmaWxlSW5wdXQiLCJyb290RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyb3V0ZXIiLCJjbGljayIsImZpbGUiLCJ0YXJnZXQiLCJmaWxlcyIsInJlYWRBc0RhdGFVUkwiLCJhZGRQaG90byIsImZhdWx0Y29kZSIsImhhbmRsZUVycm9yIiwiZHJhdyIsImFjdGlvbiIsImJsb2NraW5nRXJyb3JNZXNzYWdlIiwicGhvdG9FbGVtZW50IiwiY2xvc2VzdCIsInBob3RvSWQiLCJkYXRhc2V0IiwiaXNNYWluUGhvdG8iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImRlbGV0ZVBob3RvIiwiYnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJzZXRBc01haW5QaG90byIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbXBsb3llZSIsImlkIiwiZXJyb3JGdW5jdGlvbiIsInN1Y2Nlc3NGdW5jdGlvbiIsInBhcmFtcyIsIm1lc3NhZ2VTdHJpbmciLCJmYXVsdHN0cmluZyIsInJldmVyc2UiLCJlcnJvck1lc3NhZ2UiLCJzdHJpbmdpZnkiLCJjb25zb2xlIiwibG9nIiwicmVxdWVzdFBhdGgiLCJyZXF1ZXN0Qm9keSIsInJlcXVlc3REZWZhdWx0cyIsInZpc2lvbl9wZXJzb25faWQiLCJpbWFnZSIsInRvZ2dsZU92ZXJsYXlNZXNzYWdlIiwiZW1wbG95ZWVfaWQiLCJwaG90b19pZCIsImdhbGxlcnlDb250YWluZXIiLCJhZGQiLCJpbm5lckhUTUwiLCJtYWluUGhvdG9Db250YWluZXIiLCJnYWxsZXJ5IiwiZ2V0UGhvdG9zIiwiY3JlYXRlUGhvdG9FbGVtZW50IiwibWFpbiIsImVtcHR5IiwiY3JlYXRlTm9QaG90b0VsZW1lbnQiLCJpbml0RXZlbnRzIiwicmVzcG9uc2VKc29uIiwic3VjY2Vzc1BhcmFtcyIsInBob3RvcyIsInBhcmVudEVsZW1lbnQiLCJoYW5kbGVTdWNjZXNzIiwibWFpblBob3RvRGF0YSIsImZpbmQiLCJnYWxsZXJ5UGhvdG9zRGF0YSIsImZpbHRlciIsImdhbGxlcnlQaG90b3NIdG1sIiwicGhvdG9EYXRhIiwiY2F0Y2giLCJwYXRoIiwiYXZhdGFyVXJsIiwiZWxlbWVudENsYXNzZXMiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJtYWluQXR0cmlidXRlIiwiZ2V0UGhvdG9CdXR0b25zIiwidXBsb2FkSWNvbiIsInJlZHVjZSIsImJ1dHRvbnNTdHJpbmciXSwic291cmNlUm9vdCI6IiJ9